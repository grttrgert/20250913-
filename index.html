<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<title>5호선 전광판 스타일</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;800&amp;display=swap" rel="stylesheet"/>
<!-- CSS 파일명은 사용 중인 파일명에 맞춰 유지 -->
<link href="style.css" rel="stylesheet"/>
<style>
.direction-container{ 
  position: fixed;
  top: 80px;
  left: 30px;
  z-index: 9998;
  background: rgba(0,0,0,.4);
  border: 2px solid rgba(255,255,255,.2);
  border-radius: 8px;
  padding: 15px 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,.3);
}
.direction-container h3 {
  margin: 0 0 10px 0;
  color: var(--sign-fg);
  font-size: 1.2rem;
  font-weight: 700;
}
.direction-box{ 
  display:flex; 
  gap:15px; 
  align-items:center; 
  font-size:16px;
  color: var(--sign-fg);
}
.direction-box label {
  display: flex;
  align-items: center;
  gap: 5px;
  cursor: pointer;
  font-weight: 600;
}
.direction-box input{ 
  transform: translateY(1px);
  accent-color: var(--line1);
}
</style></head>
<body>
<!-- 검색 기능 -->
<div class="search-container">
<h3>역 검색</h3>
<div class="search-box">
<input id="station-search" placeholder="역 이름을 입력하세요" type="text"/>
<button id="search-btn">검색</button>
</div>
<div class="search-results" id="search-results"></div>
</div>
<!-- 전광판 본문 -->
<section class="sign">
<!-- 실시간 도착정보 -->
<div class="realtime-info">
<div class="station-header">
<h1 class="current-station" id="current-station">소요산</h1>
<div class="line-badge" id="line-badge">1호선</div>
</div>
<div class="arrival-info">
<div class="row">
<h2 class="label-cyanblue" id="current-train-dest">이번열차 소요산행</h2>
<p class="eta" id="next-train-1">3분 후 도착</p>
</div>
<div class="row">
<h2 class="label-gray" id="next-train-dest">다음열차 소요산행</h2>
<p class="eta" id="next-train-2">9분 후 도착</p>
</div>
</div>
</div>
<!-- 하단 5호선 라인 -->
<div class="line-map">
<div class="line-info">
<div class="line-number">1</div>
<span class="line-name">1호선</span>
</div>
<!-- 1호선 노선도 (기본 표시) -->
<div class="stations line1-stations" data-original-order="normal">
<div class="station" data-station="연천"><span>연천</span></div>
<div class="station" data-station="전곡"><span>전곡</span></div>
<div class="station" data-station="청산"><span>청산</span></div>
<div class="station" data-station="소요산"><span>소요산</span></div>
<div class="station" data-station="동두천"><span>동두천</span></div>
<div class="station" data-station="보산"><span>보산</span></div>
<div class="station" data-station="동두천중앙"><span>동두천중앙</span></div>
<div class="station" data-station="지행"><span>지행</span></div>
<div class="station" data-station="덕정"><span>덕정</span><small>(GTX-C)</small></div>
<div class="station" data-station="덕계"><span>덕계</span></div>
<div class="station" data-station="양주"><span>양주</span></div>
<div class="station" data-station="녹양"><span>녹양</span></div>
<div class="station" data-station="가능"><span>가능</span></div>
<div class="station" data-station="의정부"><span>의정부</span></div>
<div class="station" data-station="회룡"><span>회룡</span></div>
<div class="station" data-station="망월사"><span>망월사</span></div>
<div class="station" data-station="도봉산"><span>도봉산</span><small>(7호선)</small></div>
<div class="station" data-station="도봉"><span>도봉</span></div>
<div class="station" data-station="방학"><span>방학</span></div>
<div class="station" data-station="창동"><span>창동</span><small>(4호선)</small></div>
<div class="station" data-station="녹천"><span>녹천</span></div>
<div class="station" data-station="월계"><span>월계</span></div>
<div class="station" data-station="광운대"><span>광운대</span></div>
<div class="station" data-station="석계"><span>석계</span><small>(6호선)</small></div>
<div class="station" data-station="신이문"><span>신이문</span></div>
<div class="station" data-station="외대앞"><span>외대앞</span></div>
<div class="station" data-station="회기"><span>회기</span><small>(경의중앙선, 경춘선)</small></div>
<div class="station" data-station="청량리"><span>청량리</span><small>(경의중앙선, 경춘선, KTX, ITX)</small></div>
<div class="station" data-station="제기동"><span>제기동</span></div>
<div class="station" data-station="신설동"><span>신설동</span><small>(우이신설선)</small></div>
<div class="station" data-station="동묘앞"><span>동묘앞</span><small>(6호선)</small></div>
<div class="station" data-station="동대문"><span>동대문</span><small>(4호선)</small></div>
<div class="station" data-station="종로5가"><span>종로5가</span></div>
<div class="station" data-station="종로3가"><span>종로3가</span><small>(3호선, 5호선)</small></div>
<div class="station" data-station="종각"><span>종각</span><small>(2호선)</small></div>
<div class="station" data-station="시청"><span>시청</span><small>(2호선)</small></div>
<div class="station" data-station="서울역"><span>서울역</span><small>(4호선, 경의중앙선, 공항철도, KTX, ITX, SRT, GTX-A)</small></div>
<div class="station" data-station="남영"><span>남영</span></div>
<div class="station" data-station="용산"><span>용산</span><small>(경의중앙선, KTX, ITX)</small></div>
<div class="station" data-station="노량진"><span>노량진</span><small>(9호선)</small></div>
<div class="station" data-station="대방"><span>대방</span></div>
<div class="station" data-station="신길"><span>신길</span><small>(5호선)</small></div>
<div class="station" data-station="영등포"><span>영등포</span><small>(2호선, 5호선)</small></div>
<div class="station" data-station="신도림"><span>신도림</span><small>(2호선)</small></div>
<div class="station" data-station="구로"><span>구로</span><small>(2호선)</small></div>
<div class="station" data-station="가산디지털단지"><span>가산디지털단지</span><small>(7호선)</small></div>
<div class="station" data-station="독산"><span>독산</span></div>
<div class="station" data-station="금천구청"><span>금천구청</span><small>(신림선)</small></div>
<div class="station" data-station="석수"><span>석수</span></div>
<div class="station" data-station="관악"><span>관악</span></div>
<div class="station" data-station="안양"><span>안양</span></div>
<div class="station" data-station="명학"><span>명학</span></div>
<div class="station" data-station="금정"><span>금정</span><small>(GTX-C)</small></div>
<div class="station" data-station="군포"><span>군포</span></div>
<div class="station" data-station="당정"><span>당정</span></div>
<div class="station" data-station="의왕"><span>의왕</span></div>
<div class="station" data-station="성균관대"><span>성균관대</span></div>
<div class="station" data-station="화서"><span>화서</span></div>
<div class="station" data-station="수원"><span>수원</span><small>(KTX, GTX-C)</small></div>
<div class="station" data-station="세류"><span>세류</span></div>
<div class="station" data-station="병점"><span>병점</span></div>
<div class="station" data-station="세마"><span>세마</span></div>
<div class="station" data-station="오산대"><span>오산대</span></div>
<div class="station" data-station="오산"><span>오산</span></div>
<div class="station" data-station="진위"><span>진위</span></div>
<div class="station" data-station="송탄"><span>송탄</span></div>
<div class="station" data-station="서정리"><span>서정리</span></div>
<div class="station" data-station="평택지제"><span>평택지제</span></div>
<div class="station" data-station="평택"><span>평택</span></div>
<div class="station" data-station="성환"><span>성환</span></div>
<div class="station" data-station="직산"><span>직산</span></div>
<div class="station" data-station="두정"><span>두정</span></div>
<div class="station" data-station="천안"><span>천안</span></div>
<div class="station" data-station="봉명"><span>봉명</span></div>
<div class="station" data-station="쌍용"><span>쌍용(나사렛대)</span></div>
<div class="station" data-station="아산"><span>아산</span></div>
<div class="station" data-station="탕정"><span>탕정</span></div>
<div class="station" data-station="배방"><span>배방</span></div>
<div class="station" data-station="온양온천"><span>온양온천</span></div>
<div class="station" data-station="신창"><span>신창</span></div>
<div class="station" data-station="광명"><span>광명</span></div>
<div class="station" data-station="서동탄"><span>서동탄</span></div>
</div>
<!-- 2호선 본선 노선도 (기본 숨김) -->
<div class="stations line2-main-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="시청"><span>시청</span><small>(1호선)</small></div>
<div class="station" data-station="을지로입구"><span>을지로입구</span></div>
<div class="station" data-station="을지로3가"><span>을지로3가</span><small>(3호선)</small></div>
<div class="station" data-station="을지로4가"><span>을지로4가</span><small>(5호선)</small></div>
<div class="station" data-station="동대문역사문화공원"><span>동대문역사문화공원(DDP)</span><small>(4호선, 5호선)</small></div>
<div class="station" data-station="신당"><span>신당</span><small>(6호선)</small></div>
<div class="station" data-station="상왕십리"><span>상왕십리</span></div>
<div class="station" data-station="왕십리"><span>왕십리(성동구청)</span><small>(5호선, 경의중앙선, 분당선)</small></div>
<div class="station" data-station="한양대"><span>한양대</span></div>
<div class="station" data-station="뚝섬"><span>뚝섬</span><small>(분당선)</small></div>
<div class="station" data-station="성수"><span>성수</span><small>(2호선 성수지선)</small></div>
<div class="station" data-station="건대입구"><span>건대입구</span><small>(7호선)</small></div>
<div class="station" data-station="구의"><span>구의(광진구청)</span></div>
<div class="station" data-station="강변"><span>강변(동서울터미널)</span></div>
<div class="station" data-station="잠실나루"><span>잠실나루</span></div>
<div class="station" data-station="잠실"><span>잠실(송파구청)</span><small>(8호선)</small></div>
<div class="station" data-station="잠실새내"><span>잠실새내</span><small>(9호선)</small></div>
<div class="station" data-station="종합운동장"><span>종합운동장</span><small>(9호선)</small></div>
<div class="station" data-station="삼성"><span>삼성(무역센터)</span><small>(9호선)</small></div>
<div class="station" data-station="선릉"><span>선릉</span><small>(분당선)</small></div>
<div class="station" data-station="역삼"><span>역삼</span></div>
<div class="station" data-station="강남"><span>강남</span><small>(신분당선)</small></div>
<div class="station" data-station="교대"><span>교대(법원·검찰청)</span><small>(3호선)</small></div>
<div class="station" data-station="서초"><span>서초</span></div>
<div class="station" data-station="방배"><span>방배</span></div>
<div class="station" data-station="사당"><span>사당</span><small>(4호선)</small></div>
<div class="station" data-station="낙성대"><span>낙성대(강감찬)</span></div>
<div class="station" data-station="서울대입구"><span>서울대입구</span></div>
<div class="station" data-station="봉천"><span>봉천</span></div>
<div class="station" data-station="신림"><span>신림</span><small>(신림선)</small></div>
<div class="station" data-station="신대방"><span>신대방</span></div>
<div class="station" data-station="구로디지털단지"><span>구로디지털단지</span></div>
<div class="station" data-station="대림"><span>대림</span><small>(7호선)</small></div>
<div class="station" data-station="신도림"><span>신도림</span><small>(1호선)</small></div>
<div class="station" data-station="문래"><span>문래</span></div>
<div class="station" data-station="영등포구청"><span>영등포구청</span><small>(5호선)</small></div>
<div class="station" data-station="당산"><span>당산</span><small>(9호선)</small></div>
<div class="station" data-station="합정"><span>합정</span><small>(6호선)</small></div>
<div class="station" data-station="홍대입구"><span>홍대입구</span><small>(6호선, 경의중앙선, 공항철도)</small></div>
<div class="station" data-station="신촌"><span>신촌</span><small>(경의중앙선)</small></div>
<div class="station" data-station="이대"><span>이대</span></div>
<div class="station" data-station="아현"><span>아현</span></div>
<div class="station" data-station="충정로"><span>충정로</span><small>(5호선)</small></div>
</div>
<!-- 2호선 성수지선 노선도 (기본 숨김) -->
<div class="stations line2-seongsu-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="성수"><span>성수</span><small>(2호선 본선)</small></div>
<div class="station" data-station="용답"><span>용답</span></div>
<div class="station" data-station="신답"><span>신답</span></div>
<div class="station" data-station="용두"><span>용두(동대문구청)</span></div>
<div class="station" data-station="신설동"><span>신설동</span><small>(1호선, 우이신설선)</small></div>
</div>
<!-- 2호선 신정지선 노선도 (기본 숨김) -->
<div class="stations line2-sinjeong-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="신도림"><span>신도림</span><small>(1호선, 2호선 본선)</small></div>
<div class="station" data-station="도림천"><span>도림천</span></div>
<div class="station" data-station="양천구청"><span>양천구청</span></div>
<div class="station" data-station="신정네거리"><span>신정네거리</span></div>
<div class="station" data-station="까치산"><span>까치산</span><small>(5호선)</small></div>
</div>
<!-- 3호선 노선도 (기본 숨김) -->
<div class="stations line3-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="대화"><span>대화</span></div>
<div class="station" data-station="주엽"><span>주엽</span></div>
<div class="station" data-station="정발산"><span>정발산</span></div>
<div class="station" data-station="마두"><span>마두</span></div>
<div class="station" data-station="백석"><span>백석</span></div>
<div class="station" data-station="대곡"><span>대곡</span><small>(경의중앙선, 서해선, GTX-A)</small></div>
<div class="station" data-station="화정"><span>화정</span></div>
<div class="station" data-station="원당"><span>원당</span></div>
<div class="station" data-station="원흥"><span>원흥</span></div>
<div class="station" data-station="삼송"><span>삼송</span><small>(GTX-A)</small></div>
<div class="station" data-station="지축"><span>지축</span></div>
<div class="station" data-station="구파발"><span>구파발</span></div>
<div class="station" data-station="연신내"><span>연신내</span><small>(6호선, GTX-A)</small></div>
<div class="station" data-station="불광"><span>불광</span><small>(6호선)</small></div>
<div class="station" data-station="녹번"><span>녹번</span></div>
<div class="station" data-station="홍제"><span>홍제</span></div>
<div class="station" data-station="무악재"><span>무악재</span></div>
<div class="station" data-station="독립문"><span>독립문</span></div>
<div class="station" data-station="경복궁"><span>경복궁</span></div>
<div class="station" data-station="안국"><span>안국</span><small>(6호선)</small></div>
<div class="station" data-station="종로3가"><span>종로3가</span><small>(1호선, 5호선)</small></div>
<div class="station" data-station="을지로3가"><span>을지로3가</span><small>(2호선)</small></div>
<div class="station" data-station="충무로"><span>충무로</span><small>(4호선)</small></div>
<div class="station" data-station="동대입구"><span>동대입구</span></div>
<div class="station" data-station="약수"><span>약수</span><small>(6호선)</small></div>
<div class="station" data-station="금호"><span>금호</span></div>
<div class="station" data-station="옥수"><span>옥수</span><small>(경의중앙선)</small></div>
<div class="station" data-station="압구정"><span>압구정</span></div>
<div class="station" data-station="신사"><span>신사</span><small>(신분당선)</small></div>
<div class="station" data-station="잠원"><span>잠원</span></div>
<div class="station" data-station="고속터미널"><span>고속터미널</span><small>(7호선, 9호선)</small></div>
<div class="station" data-station="교대"><span>교대</span><small>(2호선)</small></div>
<div class="station" data-station="남부터미널"><span>남부터미널</span></div>
<div class="station" data-station="양재"><span>양재</span><small>(신분당선)</small></div>
<div class="station" data-station="매봉"><span>매봉</span></div>
<div class="station" data-station="도곡"><span>도곡</span></div>
<div class="station" data-station="대치"><span>대치</span></div>
<div class="station" data-station="학여울"><span>학여울</span></div>
<div class="station" data-station="대청"><span>대청</span></div>
<div class="station" data-station="일원"><span>일원</span></div>
<div class="station" data-station="수서"><span>수서</span><small>(SRT, GTX-A)</small></div>
<div class="station" data-station="가락시장"><span>가락시장</span></div>
<div class="station" data-station="경찰병원"><span>경찰병원</span></div>
<div class="station" data-station="오금"><span>오금</span></div>
</div>
<!-- 4호선 노선도 (기본 숨김) -->
<div class="stations line4-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="당고개"><span>당고개</span></div>
<div class="station" data-station="상계"><span>상계</span></div>
<div class="station" data-station="노원"><span>노원</span><small>(7호선)</small></div>
<div class="station" data-station="창동"><span>창동</span><small>(1호선, GTX-C)</small></div>
<div class="station" data-station="쌍문"><span>쌍문</span></div>
<div class="station" data-station="수유"><span>수유</span></div>
<div class="station" data-station="미아"><span>미아</span></div>
<div class="station" data-station="미아사거리"><span>미아사거리</span></div>
<div class="station" data-station="길음"><span>길음</span></div>
<div class="station" data-station="성신여대입구"><span>성신여대입구</span><small>(우이신설선)</small></div>
<div class="station" data-station="한성대입구"><span>한성대입구</span></div>
<div class="station" data-station="혜화"><span>혜화</span></div>
<div class="station" data-station="동대문"><span>동대문</span><small>(1호선)</small></div>
<div class="station" data-station="동대문역사문화공원"><span>동대문역사문화공원</span><small>(2호선, 5호선)</small></div>
<div class="station" data-station="충무로"><span>충무로</span><small>(3호선)</small></div>
<div class="station" data-station="명동"><span>명동</span></div>
<div class="station" data-station="회현"><span>회현</span></div>
<div class="station" data-station="서울역"><span>서울역</span><small>(1호선, 경의중앙선, 공항철도)</small></div>
<div class="station" data-station="숙대입구"><span>숙대입구</span></div>
<div class="station" data-station="삼각지"><span>삼각지</span><small>(6호선)</small></div>
<div class="station" data-station="신용산"><span>신용산</span></div>
<div class="station" data-station="이촌"><span>이촌</span><small>(경의중앙선)</small></div>
<div class="station" data-station="동작"><span>동작</span><small>(9호선)</small></div>
<div class="station" data-station="총신대입구"><span>총신대입구</span></div>
<div class="station" data-station="사당"><span>사당</span><small>(2호선)</small></div>
<div class="station" data-station="남태령"><span>남태령</span></div>
<div class="station" data-station="선바위"><span>선바위</span></div>
<div class="station" data-station="경마공원"><span>경마공원</span></div>
<div class="station" data-station="대공원"><span>대공원</span></div>
<div class="station" data-station="과천"><span>과천</span></div>
<div class="station" data-station="정부과천청사"><span>정부과천청사</span></div>
<div class="station" data-station="인덕원"><span>인덕원</span></div>
<div class="station" data-station="평촌"><span>평촌</span></div>
<div class="station" data-station="범계"><span>범계</span></div>
<div class="station" data-station="금정"><span>금정</span><small>(GTX-C)</small></div>
<div class="station" data-station="산본"><span>산본</span></div>
<div class="station" data-station="수리산"><span>수리산</span></div>
<div class="station" data-station="대야미"><span>대야미</span></div>
<div class="station" data-station="반월"><span>반월</span></div>
<div class="station" data-station="상록수"><span>상록수</span></div>
<div class="station" data-station="한대앞"><span>한대앞</span></div>
<div class="station" data-station="중앙"><span>중앙</span></div>
<div class="station" data-station="고잔"><span>고잔</span></div>
<div class="station" data-station="초지"><span>초지</span></div>
<div class="station" data-station="안산"><span>안산</span></div>
<div class="station" data-station="신길온천"><span>신길온천</span></div>
<div class="station" data-station="정왕"><span>정왕</span></div>
<div class="station" data-station="오이도"><span>오이도</span></div>
</div>
<!-- 5호선 노선도 (기본 숨김) -->
<div class="stations line5-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="방화"><span>방화</span></div>
<div class="station" data-station="개화산"><span>개화산</span></div>
<div class="station" data-station="김포공항"><span>김포공항</span><small>(공항철도)</small></div>
<div class="station" data-station="송정"><span>송정</span></div>
<div class="station" data-station="마곡"><span>마곡</span></div>
<div class="station" data-station="발산"><span>발산</span></div>
<div class="station" data-station="우장산"><span>우장산</span></div>
<div class="station" data-station="화곡"><span>화곡</span></div>
<div class="station" data-station="까치산"><span>까치산</span><small>(2호선 신정지선)</small></div>
<div class="station" data-station="신정"><span>신정</span></div>
<div class="station" data-station="목동"><span>목동</span></div>
<div class="station" data-station="오목교"><span>오목교</span></div>
<div class="station" data-station="양평"><span>양평</span></div>
<div class="station" data-station="영등포구청"><span>영등포구청</span><small>(2호선)</small></div>
<div class="station" data-station="영등포시장"><span>영등포시장</span></div>
<div class="station" data-station="신길"><span>신길</span><small>(1호선)</small></div>
<div class="station" data-station="여의도"><span>여의도</span><small>(9호선)</small></div>
<div class="station" data-station="여의나루"><span>여의나루</span></div>
<div class="station" data-station="마포"><span>마포</span></div>
<div class="station" data-station="애오개"><span>애오개</span></div>
<div class="station" data-station="충정로"><span>충정로</span><small>(2호선)</small></div>
<div class="station" data-station="서대문"><span>서대문</span></div>
<div class="station" data-station="광화문"><span>광화문</span></div>
<div class="station" data-station="종로3가"><span>종로3가</span><small>(1호선, 3호선)</small></div>
<div class="station" data-station="을지로4가"><span>을지로4가</span><small>(2호선)</small></div>
<div class="station" data-station="동대문역사문화공원"><span>동대문역사문화공원</span><small>(2호선, 4호선)</small></div>
<div class="station" data-station="청구"><span>청구</span></div>
<div class="station" data-station="신금호"><span>신금호</span></div>
<div class="station" data-station="행당"><span>행당</span></div>
<div class="station" data-station="왕십리"><span>왕십리</span><small>(2호선, 경의중앙선, 분당선)</small></div>
<div class="station" data-station="마장"><span>마장</span></div>
<div class="station" data-station="답십리"><span>답십리</span></div>
<div class="station" data-station="장한평"><span>장한평</span></div>
<div class="station" data-station="군자"><span>군자</span><small>(7호선)</small></div>
<div class="station" data-station="아차산"><span>아차산</span></div>
<div class="station" data-station="광나루"><span>광나루</span></div>
<div class="station" data-station="천호"><span>천호</span></div>
<div class="station" data-station="강동"><span>강동</span></div>
<div class="station" data-station="길동"><span>길동</span></div>
<div class="station" data-station="굽은다리"><span>굽은다리</span></div>
<div class="station" data-station="명일"><span>명일</span></div>
<div class="station" data-station="고덕"><span>고덕</span></div>
<div class="station" data-station="상일동"><span>상일동</span></div>
<div class="station" data-station="강일"><span>강일</span></div>
<div class="station" data-station="미사"><span>미사</span></div>
<div class="station" data-station="하남풍산"><span>하남풍산</span></div>
<div class="station" data-station="하남시청"><span>하남시청</span></div>
<div class="station" data-station="하남검단산"><span>하남검단산</span></div>
</div>
<!-- 6호선 노선도 (기본 숨김) -->
<div class="stations line6-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="응암"><span>응암</span></div>
<div class="station" data-station="역촌"><span>역촌</span></div>
<div class="station" data-station="불광"><span>불광</span></div>
<div class="station" data-station="독바위"><span>독바위</span></div>
<div class="station" data-station="연신내"><span>연신내</span></div>
<div class="station" data-station="구산"><span>구산</span></div>
<div class="station" data-station="새절"><span>새절</span></div>
<div class="station" data-station="증산"><span>증산</span></div>
<div class="station" data-station="디지털미디어시티"><span>디지털미디어시티</span></div>
<div class="station" data-station="월드컵경기장"><span>월드컵경기장</span></div>
<div class="station" data-station="마포구청"><span>마포구청</span></div>
<div class="station" data-station="망원"><span>망원</span></div>
<div class="station" data-station="합정"><span>합정</span></div>
<div class="station" data-station="상수"><span>상수</span></div>
<div class="station" data-station="광흥창"><span>광흥창</span></div>
<div class="station" data-station="대흥"><span>대흥</span></div>
<div class="station" data-station="효창공원앞"><span>효창공원앞</span></div>
<div class="station" data-station="삼각지"><span>삼각지</span></div>
<div class="station" data-station="녹사평"><span>녹사평</span></div>
<div class="station" data-station="이태원"><span>이태원</span></div>
<div class="station" data-station="한강진"><span>한강진</span></div>
<div class="station" data-station="버티고개"><span>버티고개</span></div>
<div class="station" data-station="약수"><span>약수</span></div>
<div class="station" data-station="청구"><span>청구</span></div>
<div class="station" data-station="신당"><span>신당</span></div>
<div class="station" data-station="동묘앞"><span>동묘앞</span></div>
<div class="station" data-station="창신"><span>창신</span></div>
<div class="station" data-station="보문"><span>보문</span></div>
<div class="station" data-station="안암"><span>안암</span></div>
<div class="station" data-station="고려대"><span>고려대</span></div>
<div class="station" data-station="월곡"><span>월곡</span></div>
<div class="station" data-station="상월곡"><span>상월곡</span></div>
<div class="station" data-station="돌곶이"><span>돌곶이</span></div>
<div class="station" data-station="석계"><span>석계</span></div>
<div class="station" data-station="태릉입구"><span>태릉입구</span></div>
<div class="station" data-station="화랑대"><span>화랑대</span></div>
<div class="station" data-station="봉화산"><span>봉화산</span></div>
<div class="station" data-station="신내"><span>신내</span></div>
</div>
<!-- 7호선 노선도 (기본 숨김) -->
<div class="stations line7-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="석남"><span>석남</span></div>
<div class="station" data-station="도봉산"><span>도봉산</span></div>
<div class="station" data-station="수락산"><span>수락산</span></div>
<div class="station" data-station="마들"><span>마들</span></div>
<div class="station" data-station="노원"><span>노원</span></div>
<div class="station" data-station="중계"><span>중계</span></div>
<div class="station" data-station="하계"><span>하계</span></div>
<div class="station" data-station="공릉"><span>공릉</span></div>
<div class="station" data-station="태릉입구"><span>태릉입구</span></div>
<div class="station" data-station="먹골"><span>먹골</span></div>
<div class="station" data-station="중화"><span>중화</span></div>
<div class="station" data-station="상봉"><span>상봉</span><small>(ITX-청춘)</small></div>
<div class="station" data-station="면목"><span>면목</span></div>
<div class="station" data-station="사가정"><span>사가정</span></div>
<div class="station" data-station="용마산"><span>용마산</span></div>
<div class="station" data-station="중곡"><span>중곡</span></div>
<div class="station" data-station="군자"><span>군자</span></div>
<div class="station" data-station="어린이대공원"><span>어린이대공원</span></div>
<div class="station" data-station="건대입구"><span>건대입구</span></div>
<div class="station" data-station="뚝섬유원지"><span>뚝섬유원지</span></div>
<div class="station" data-station="청담"><span>청담</span></div>
<div class="station" data-station="강남구청"><span>강남구청</span></div>
<div class="station" data-station="학동"><span>학동</span></div>
<div class="station" data-station="논현"><span>논현</span></div>
<div class="station" data-station="반포"><span>반포</span></div>
<div class="station" data-station="고속터미널"><span>고속터미널</span></div>
<div class="station" data-station="내방"><span>내방</span></div>
<div class="station" data-station="총신대입구"><span>총신대입구</span></div>
<div class="station" data-station="남성"><span>남성</span></div>
<div class="station" data-station="숭실대입구"><span>숭실대입구</span></div>
<div class="station" data-station="상도"><span>상도</span></div>
<div class="station" data-station="장승배기"><span>장승배기</span></div>
<div class="station" data-station="신대방삼거리"><span>신대방삼거리</span></div>
<div class="station" data-station="보라매"><span>보라매</span></div>
<div class="station" data-station="신풍"><span>신풍</span></div>
<div class="station" data-station="대림"><span>대림</span></div>
<div class="station" data-station="남구로"><span>남구로</span></div>
<div class="station" data-station="가산디지털단지"><span>가산디지털단지</span></div>
<div class="station" data-station="철산"><span>철산</span></div>
<div class="station" data-station="광명사거리"><span>광명사거리</span></div>
<div class="station" data-station="천왕"><span>천왕</span></div>
<div class="station" data-station="온수"><span>온수</span></div>
<div class="station" data-station="까치울"><span>까치울</span></div>
<div class="station" data-station="부천종합운동장"><span>부천종합운동장</span></div>
<div class="station" data-station="춘의"><span>춘의</span></div>
<div class="station" data-station="신중동"><span>신중동</span></div>
<div class="station" data-station="부천시청"><span>부천시청</span></div>
<div class="station" data-station="상동"><span>상동</span></div>
<div class="station" data-station="삼산체육관"><span>삼산체육관</span></div>
<div class="station" data-station="굴포천"><span>굴포천</span></div>
<div class="station" data-station="부평구청"><span>부평구청</span></div>
<div class="station" data-station="산곡"><span>산곡</span></div>
</div>
<!-- 8호선 노선도 (기본 숨김) -->
<div class="stations line8-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="모란"><span>모란</span></div>
<div class="station" data-station="천호"><span>천호</span></div>
<div class="station" data-station="강동구청"><span>강동구청</span></div>
<div class="station" data-station="몽촌토성"><span>몽촌토성</span></div>
<div class="station" data-station="잠실"><span>잠실</span></div>
<div class="station" data-station="석촌"><span>석촌</span></div>
<div class="station" data-station="송파"><span>송파</span></div>
<div class="station" data-station="가락시장"><span>가락시장</span></div>
<div class="station" data-station="문정"><span>문정</span></div>
<div class="station" data-station="장지"><span>장지</span></div>
<div class="station" data-station="복정"><span>복정</span></div>
<div class="station" data-station="남위례"><span>남위례</span></div>
<div class="station" data-station="산성"><span>산성</span></div>
<div class="station" data-station="남한산성입구"><span>남한산성입구</span></div>
<div class="station" data-station="단대오거리"><span>단대오거리</span></div>
<div class="station" data-station="신흥"><span>신흥</span></div>
<div class="station" data-station="수진"><span>수진</span></div>
</div>
<!-- 9호선 노선도 (기본 숨김) -->
<div class="stations line9-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="개화"><span>개화</span></div>
<div class="station" data-station="김포공항"><span>김포공항</span></div>
<div class="station" data-station="공항시장"><span>공항시장</span></div>
<div class="station" data-station="신방화"><span>신방화</span></div>
<div class="station" data-station="마곡나루"><span>마곡나루</span></div>
<div class="station" data-station="양천향교"><span>양천향교</span></div>
<div class="station" data-station="가양"><span>가양</span></div>
<div class="station" data-station="증미"><span>증미</span></div>
<div class="station" data-station="등촌"><span>등촌</span></div>
<div class="station" data-station="염창"><span>염창</span></div>
<div class="station" data-station="신목동"><span>신목동</span></div>
<div class="station" data-station="선유도"><span>선유도</span></div>
<div class="station" data-station="당산"><span>당산</span></div>
<div class="station" data-station="국회의사당"><span>국회의사당</span></div>
<div class="station" data-station="여의도"><span>여의도</span></div>
<div class="station" data-station="샛강"><span>샛강</span></div>
<div class="station" data-station="노들"><span>노들</span></div>
<div class="station" data-station="흑석"><span>흑석</span></div>
<div class="station" data-station="동작"><span>동작</span></div>
<div class="station" data-station="구반포"><span>구반포</span></div>
<div class="station" data-station="신반포"><span>신반포</span></div>
<div class="station" data-station="고속터미널"><span>고속터미널</span></div>
<div class="station" data-station="사평"><span>사평</span></div>
<div class="station" data-station="신논현"><span>신논현</span></div>
<div class="station" data-station="언주"><span>언주</span></div>
<div class="station" data-station="선정릉"><span>선정릉</span></div>
<div class="station" data-station="삼성중앙"><span>삼성중앙</span></div>
<div class="station" data-station="봉은사"><span>봉은사</span></div>
<div class="station" data-station="종합운동장"><span>종합운동장</span></div>
<div class="station" data-station="삼전"><span>삼전</span></div>
<div class="station" data-station="석촌고분"><span>석촌고분</span></div>
<div class="station" data-station="석촌"><span>석촌</span></div>
<div class="station" data-station="송파나루"><span>송파나루</span></div>
<div class="station" data-station="한성백제"><span>한성백제</span></div>
<div class="station" data-station="올림픽공원"><span>올림픽공원</span></div>
<div class="station" data-station="둔촌오륜"><span>둔촌오륜</span></div>
<div class="station" data-station="중앙보훈병원"><span>중앙보훈병원</span></div>
</div>
<!-- 신분당선 노선도 (기본 숨김) -->
<div class="stations shinbundang-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="신사"><span>신사</span></div>
<div class="station" data-station="논현"><span>논현</span></div>
<div class="station" data-station="신논현"><span>신논현</span></div>
<div class="station" data-station="강남"><span>강남</span><small>(2호선)</small></div>
<div class="station" data-station="양재"><span>양재(서초구청)</span><small>(3호선)</small></div>
<div class="station" data-station="양재시민의숲"><span>양재시민의숲(매헌)</span></div>
<div class="station" data-station="청계산입구"><span>청계산입구</span></div>
<div class="station" data-station="판교"><span>판교(판교테크노밸리)</span><small>(GTX-A)</small><span class="construction">공사중</span></div>
<div class="station" data-station="정자"><span>정자</span></div>
<div class="station" data-station="미금"><span>미금</span></div>
<div class="station" data-station="동천"><span>동천</span></div>
<div class="station" data-station="수지구청"><span>수지구청</span></div>
<div class="station" data-station="성복"><span>성복</span></div>
<div class="station" data-station="상현"><span>상현</span></div>
<div class="station" data-station="광교중앙"><span>광교중앙(아주대)</span></div>
<div class="station" data-station="광교"><span>광교(경기대)</span></div>
</div>
<!-- ✅ 경의·중앙선(통합) -->
<div class="stations gyeongui-jungang-stations" style="display: none;">
  <div class="station" data-station="문산"><span>문산</span></div>
  <div class="station" data-station="파주"><span>파주</span></div>
  <div class="station" data-station="월롱"><span>월롱</span></div>
  <div class="station" data-station="금촌"><span>금촌</span></div>
  <div class="station" data-station="금릉"><span>금릉</span></div>
  <div class="station" data-station="운정"><span>운정</span></div>
  <div class="station" data-station="야당"><span>야당</span></div>
  <div class="station" data-station="탄현"><span>탄현</span></div>
  <div class="station" data-station="일산"><span>일산</span></div>
  <div class="station" data-station="풍산"><span>풍산</span></div>
  <div class="station" data-station="백마"><span>백마</span></div>
  <div class="station" data-station="곡산"><span>곡산</span></div>
  <div class="station" data-station="대곡"><span>대곡</span><small>(3호선)</small></div>
  <div class="station" data-station="능곡"><span>능곡</span></div>
  <div class="station" data-station="행신"><span>행신</span></div>
  <div class="station" data-station="강매"><span>강매</span></div>
  <div class="station" data-station="화전"><span>화전</span></div>
  <div class="station" data-station="수색"><span>수색</span></div>
  <div class="station" data-station="디지털미디어시티"><span>디지털미디어시티</span><small>(6호선, 공항철도)</small></div>
  <div class="station" data-station="가좌"><span>가좌</span></div>
  <div class="station" data-station="홍대입구"><span>홍대입구</span><small>(2호선, 6호선, 공항철도)</small></div>
  <div class="station" data-station="신촌"><span>신촌</span></div>
  <div class="station" data-station="서울역"><span>서울역</span><small>(1호선, 4호선, 공항철도, KTX, ITX, SRT, GTX-A)</small></div>
  <div class="station" data-station="공덕"><span>공덕</span><small>(5호선, 6호선, 공항철도)</small></div>
  <div class="station" data-station="효창공원앞"><span>효창공원앞</span><small>(6호선)</small></div>
  <div class="station" data-station="용산"><span>용산</span><small>(1호선, KTX, ITX)</small></div>
  <div class="station" data-station="이촌"><span>이촌</span><small>(4호선)</small></div>
  <div class="station" data-station="서빙고"><span>서빙고</span></div>
  <div class="station" data-station="한남"><span>한남</span></div>
  <div class="station" data-station="옥수"><span>옥수</span><small>(3호선)</small></div>
  <div class="station" data-station="응봉"><span>응봉</span></div>
  <div class="station" data-station="왕십리"><span>왕십리</span><small>(2호선, 5호선, 분당선)</small></div>
  <div class="station" data-station="청량리"><span>청량리</span><small>(1호선, 경춘선, KTX, ITX)</small></div>
  <div class="station" data-station="회기"><span>회기</span><small>(1호선, 경춘선)</small></div>
  <div class="station" data-station="중랑"><span>중랑</span><small>(경춘선)</small></div>
  <div class="station" data-station="상봉"><span>상봉</span><small>(7호선, 경춘선, ITX-청춘)</small></div>
  <div class="station" data-station="망우"><span>망우</span><small>(경춘선)</small></div>
  <div class="station" data-station="양원"><span>양원</span></div>
  <div class="station" data-station="구리"><span>구리</span></div>
  <div class="station" data-station="도농"><span>도농</span></div>
  <div class="station" data-station="양정"><span>양정</span></div>
  <div class="station" data-station="덕소"><span>덕소</span></div>
  <div class="station" data-station="도심"><span>도심</span></div>
  <div class="station" data-station="팔당"><span>팔당</span></div>
  <div class="station" data-station="운길산"><span>운길산</span></div>
  <div class="station" data-station="양수"><span>양수</span></div>
  <div class="station" data-station="신원"><span>신원</span></div>
  <div class="station" data-station="국수"><span>국수</span></div>
  <div class="station" data-station="아신"><span>아신</span></div>
  <div class="station" data-station="오빈"><span>오빈</span></div>
  <div class="station" data-station="양평"><span>양평</span></div>
  <div class="station" data-station="원덕"><span>원덕</span></div>
  <div class="station" data-station="용문"><span>용문</span></div>
  <div class="station" data-station="지평"><span>지평</span></div>
</div>

<!-- GTX-A 노선도 -->
<div class="stations gtx-a-stations" style="display: none;">
  <div class="station" data-station="운정"><span>운정</span><span class="construction">공사중</span></div>
  <div class="station" data-station="킨텍스"><span>킨텍스</span></div>
  <div class="station" data-station="대곡"><span>대곡</span><small>(3호선, 경의중앙선, 서해선)</small></div>
  <div class="station" data-station="연신내"><span>연신내</span><small>(3호선, 6호선)</small></div>
  <div class="station" data-station="서울역"><span>서울역</span><small>(1호선, 4호선, 경의중앙선, 공항철도, KTX, ITX, SRT, GTX-B)</small></div>
  <div class="station" data-station="삼성"><span>삼성</span><small>(2호선, 9호선, GTX-C)</small><span class="construction">공사중</span></div>
  <div class="station" data-station="수서"><span>수서</span><small>(3호선, 수인분당선, SRT)</small></div>
  <div class="station" data-station="성남"><span>성남</span><small>(경강선)</small></div>
  <div class="station" data-station="용인"><span>용인</span><small>(수인분당선)</small><span class="construction">공사중</span></div>
  <div class="station" data-station="동탄"><span>동탄</span><small>(1호선, 동탄인덕원선)</small><span class="construction">공사중</span></div>
</div>

<!-- 우이신설선 노선도 -->
<div class="stations ui-sinseol-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="신설동"><span>신설동</span></div>
<div class="station" data-station="보문"><span>보문</span></div>
<div class="station" data-station="성신여대입구"><span>성신여대입구</span></div>
<div class="station" data-station="정릉"><span>정릉</span></div>
<div class="station" data-station="북한산보국문"><span>북한산보국문</span></div>
<div class="station" data-station="솔샘"><span>솔샘</span></div>
<div class="station" data-station="삼양사거리"><span>삼양사거리</span></div>
<div class="station" data-station="삼양"><span>삼양</span></div>
<div class="station" data-station="화계"><span>화계</span></div>
<div class="station" data-station="가오리"><span>가오리</span></div>
<div class="station" data-station="4.19민주묘지"><span>4.19민주묘지</span></div>
<div class="station" data-station="솔밭공원"><span>솔밭공원</span></div>
<div class="station" data-station="북한산우이"><span>북한산우이</span></div>
</div>
<!-- 신림선 노선도 -->
<div class="stations sillim-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="신림"><span>신림</span><small>(2호선)</small></div>
<div class="station" data-station="샛강"><span>샛강</span><span class="construction">공사중</span></div>
<div class="station" data-station="대방"><span>대방</span></div>
<div class="station" data-station="서울지방병무청"><span>서울지방병무청</span></div>
<div class="station" data-station="보라매"><span>보라매</span></div>
<div class="station" data-station="보라매공원"><span>보라매공원</span></div>
<div class="station" data-station="보라매병원"><span>보라매병원</span></div>
<div class="station" data-station="당곡"><span>당곡</span></div>
<div class="station" data-station="서원"><span>서원</span></div>
<div class="station" data-station="서울대벤처타운"><span>서울대벤처타운</span></div>
<div class="station" data-station="관악산"><span>관악산</span></div>
</div>
<!-- 의정부경전철 노선도 -->
<div class="stations uijeongbu-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="발곡"><span>발곡</span></div>
<div class="station" data-station="회룡"><span>회룡</span><small>(1호선)</small></div>
<div class="station" data-station="범골"><span>범골</span></div>
<div class="station" data-station="경전철의정부"><span>경전철의정부</span></div>
<div class="station" data-station="의정부시청"><span>의정부시청</span></div>
<div class="station" data-station="흥선"><span>흥선</span></div>
<div class="station" data-station="의정부중앙"><span>의정부중앙</span></div>
<div class="station" data-station="동오"><span>동오</span></div>
<div class="station" data-station="새말"><span>새말</span></div>
<div class="station" data-station="경기도청북부청사"><span>경기도청북부청사</span></div>
<div class="station" data-station="효자"><span>효자</span></div>
<div class="station" data-station="곤제"><span>곤제</span></div>
<div class="station" data-station="어룡"><span>어룡</span></div>
<div class="station" data-station="송산"><span>송산</span></div>
<div class="station" data-station="탑석"><span>탑석</span></div>
<div class="station" data-station="차량기지임시승강장"><span>차량기지임시승강장</span></div>
</div>
<!-- 용인에버라인 노선도 -->
<div class="stations yongin-everline-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="용인"><span>용인</span></div>
<div class="station" data-station="기흥"><span>기흥</span><small>(분당선)</small></div>
<div class="station" data-station="강남대"><span>강남대</span></div>
<div class="station" data-station="지석"><span>지석</span></div>
<div class="station" data-station="어정"><span>어정</span></div>
<div class="station" data-station="동백"><span>동백</span></div>
<div class="station" data-station="초당"><span>초당</span></div>
<div class="station" data-station="삼가"><span>삼가</span></div>
<div class="station" data-station="시청·용인대"><span>시청·용인대</span></div>
<div class="station" data-station="명지대"><span>명지대</span></div>
<div class="station" data-station="김량장"><span>김량장</span></div>
<div class="station" data-station="운동장·송담대"><span>운동장·송담대</span></div>
<div class="station" data-station="고진"><span>고진</span></div>
<div class="station" data-station="보평"><span>보평</span></div>
<div class="station" data-station="둔전"><span>둔전</span></div>
<div class="station" data-station="전대·에버랜드"><span>전대·에버랜드</span></div>
</div>
<!-- 분당선 노선도 -->
<div class="stations bundang-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="청량리"><span>청량리</span><small>(1호선, 경의중앙선, 경춘선, KTX, ITX)</small></div>
<div class="station" data-station="왕십리"><span>왕십리</span><small>(2호선, 5호선, 경의중앙선)</small></div>
<div class="station" data-station="서울숲"><span>서울숲</span></div>
<div class="station" data-station="압구정로데오"><span>압구정로데오</span></div>
<div class="station" data-station="강남구청"><span>강남구청</span><small>(7호선)</small></div>
<div class="station" data-station="선정릉"><span>선정릉</span><small>(9호선)</small></div>
<div class="station" data-station="선릉"><span>선릉</span><small>(2호선)</small></div>
<div class="station" data-station="한티"><span>한티</span></div>
<div class="station" data-station="도곡"><span>도곡</span><small>(3호선)</small></div>
<div class="station" data-station="구룡"><span>구룡</span></div>
<div class="station" data-station="개포동"><span>개포동</span></div>
<div class="station" data-station="대모산입구"><span>대모산입구</span></div>
<div class="station" data-station="수서"><span>수서</span><small>(3호선, SRT, GTX-A)</small></div>
<div class="station" data-station="복정"><span>복정</span><small>(8호선)</small></div>
<div class="station" data-station="가천대"><span>가천대</span></div>
<div class="station" data-station="태평"><span>태평</span></div>
<div class="station" data-station="모란"><span>모란</span><small>(8호선)</small></div>
<div class="station" data-station="야탑"><span>야탑</span></div>
<div class="station" data-station="이매"><span>이매</span><small>(경강선)</small></div>
<div class="station" data-station="서현"><span>서현</span></div>
<div class="station" data-station="수내"><span>수내</span></div>
<div class="station" data-station="정자"><span>정자</span><small>(신분당선)</small></div>
<div class="station" data-station="미금"><span>미금</span><small>(신분당선)</small></div>
<div class="station" data-station="오리"><span>오리</span><small>(신분당선)</small></div>
<div class="station" data-station="죽전"><span>죽전</span></div>
<div class="station" data-station="보정"><span>보정</span></div>
<div class="station" data-station="구성"><span>구성</span><small>(GTX-A)</small><span class="construction">공사중</span></div>
<div class="station" data-station="신갈"><span>신갈</span></div>
<div class="station" data-station="기흥"><span>기흥</span><small>(용인에버라인)</small></div>
<div class="station" data-station="상갈"><span>상갈</span></div>
<div class="station" data-station="청명"><span>청명</span></div>
<div class="station" data-station="영통"><span>영통</span></div>
<div class="station" data-station="망포"><span>망포</span></div>
<div class="station" data-station="매탄권선"><span>매탄권선</span></div>
<div class="station" data-station="수원시청"><span>수원시청</span></div>
<div class="station" data-station="매교"><span>매교</span></div>
<div class="station" data-station="수원"><span>수원</span><small>(1호선, KTX, GTX-C)</small></div>
</div>

<!-- 경춘선 노선도 -->
<div class="stations gyeongchun-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="청량리"><span>청량리</span><small>(1호선, 경의중앙선, 분당선, KTX, ITX)</small></div>
<div class="station" data-station="회기"><span>회기</span><small>(1호선, 경의중앙선)</small></div>
<div class="station" data-station="중랑"><span>중랑</span><small>(경의중앙선)</small></div>
<div class="station" data-station="상봉"><span>상봉</span><small>(7호선, 경의중앙선, ITX-청춘)</small></div>
<div class="station" data-station="망우"><span>망우</span><small>(경의중앙선)</small></div>
<div class="station" data-station="신내"><span>신내</span></div>
<div class="station" data-station="갈매"><span>갈매</span></div>
<div class="station" data-station="별내"><span>별내</span></div>
<div class="station" data-station="퇴계원"><span>퇴계원</span></div>
<div class="station" data-station="사릉"><span>사릉</span></div>
<div class="station" data-station="금곡"><span>금곡</span></div>
<div class="station" data-station="평내호평"><span>평내호평</span></div>
<div class="station" data-station="천마산"><span>천마산</span></div>
<div class="station" data-station="마석"><span>마석</span></div>
<div class="station" data-station="대성리"><span>대성리</span></div>
<div class="station" data-station="청평"><span>청평</span></div>
<div class="station" data-station="상천"><span>상천</span></div>
<div class="station" data-station="가평"><span>가평</span></div>
<div class="station" data-station="굴봉산"><span>굴봉산</span></div>
<div class="station" data-station="백양리"><span>백양리</span></div>
<div class="station" data-station="강촌"><span>강촌</span></div>
<div class="station" data-station="김유정"><span>김유정</span></div>
<div class="station" data-station="남춘천"><span>남춘천</span></div>
<div class="station" data-station="춘천"><span>춘천</span></div>
</div>

<!-- 경강선 노선도 -->
<div class="stations gyeonggang-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="판교"><span>판교</span><small>(신분당선, GTX-A)</small><span class="construction">공사중</span></div>
<div class="station" data-station="성남"><span>성남</span><small>(GTX-A)</small></div>
<div class="station" data-station="이매"><span>이매</span><small>(수인분당선)</small></div>
<div class="station" data-station="삼동"><span>삼동</span></div>
<div class="station" data-station="경기광주"><span>경기광주</span></div>
<div class="station" data-station="초월"><span>초월</span></div>
<div class="station" data-station="곤지암"><span>곤지암</span></div>
<div class="station" data-station="신둔도예촌"><span>신둔도예촌</span></div>
<div class="station" data-station="이천"><span>이천</span></div>
<div class="station" data-station="부발"><span>부발</span></div>
<div class="station" data-station="세종대왕릉"><span>세종대왕릉</span></div>
<div class="station" data-station="여주"><span>여주</span></div>
</div>
<!-- 인천1호선 노선도 -->
<div class="stations incheon1-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="검단"><span>검단</span></div>
<div class="station" data-station="인천원당"><span>인천원당</span></div>
<div class="station" data-station="계양천"><span>계양천</span></div>
<div class="station" data-station="계양"><span>계양</span></div>
<div class="station" data-station="귤현"><span>귤현</span></div>
<div class="station" data-station="박촌"><span>박촌</span></div>
<div class="station" data-station="임학"><span>임학</span></div>
<div class="station" data-station="계산"><span>계산</span></div>
<div class="station" data-station="경인교대입구"><span>경인교대입구</span></div>
<div class="station" data-station="작전"><span>작전</span></div>
<div class="station" data-station="갈산"><span>갈산</span></div>
<div class="station" data-station="부평"><span>부평</span><small>(1호선)</small></div>
<div class="station" data-station="동수"><span>동수</span></div>
<div class="station" data-station="부평삼거리"><span>부평삼거리</span></div>
<div class="station" data-station="간석오거리"><span>간석오거리</span></div>
<div class="station" data-station="인천시청"><span>인천시청</span><small>(GTX-B)</small></div>
<div class="station" data-station="예술회관"><span>예술회관</span></div>
<div class="station" data-station="인천터미널"><span>인천터미널</span></div>
<div class="station" data-station="문학경기장"><span>문학경기장</span></div>
<div class="station" data-station="선학"><span>선학</span></div>
<div class="station" data-station="신연수"><span>신연수</span></div>
<div class="station" data-station="원인재"><span>원인재</span></div>
<div class="station" data-station="동춘"><span>동춘</span></div>
<div class="station" data-station="동막"><span>동막</span></div>
<div class="station" data-station="캠퍼스타운"><span>캠퍼스타운</span></div>
<div class="station" data-station="테크노파크"><span>테크노파크</span></div>
<div class="station" data-station="지식정보단지"><span>지식정보단지</span></div>
<div class="station" data-station="인천대입구"><span>인천대입구</span></div>
<div class="station" data-station="센트럴파크"><span>센트럴파크</span></div>
<div class="station" data-station="국제업무지구"><span>국제업무지구</span></div>
<div class="station" data-station="송도"><span>송도</span></div>
<div class="station" data-station="달빛축제공원"><span>달빛축제공원</span></div>
</div>
<!-- 인천2호선 노선도 -->
<div class="stations incheon2-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="검단오류"><span>검단오류</span></div>
<div class="station" data-station="왕길"><span>왕길</span></div>
<div class="station" data-station="검단사거리"><span>검단사거리</span></div>
<div class="station" data-station="마전"><span>마전</span></div>
<div class="station" data-station="완정"><span>완정</span></div>
<div class="station" data-station="독정"><span>독정</span></div>
<div class="station" data-station="검암"><span>검암</span></div>
<div class="station" data-station="검바위"><span>검바위</span></div>
<div class="station" data-station="아시아드경기장"><span>아시아드경기장</span></div>
<div class="station" data-station="서구청"><span>서구청</span></div>
<div class="station" data-station="가정"><span>가정</span></div>
<div class="station" data-station="가정중앙시장"><span>가정중앙시장</span></div>
<div class="station" data-station="석남"><span>석남</span></div>
<div class="station" data-station="서부여성회관"><span>서부여성회관</span></div>
<div class="station" data-station="인천가좌"><span>인천가좌</span></div>
<div class="station" data-station="가재울"><span>가재울</span></div>
<div class="station" data-station="주안국가산단"><span>주안국가산단</span></div>
<div class="station" data-station="주안"><span>주안</span><small>(1호선)</small></div>
<div class="station" data-station="시민공원"><span>시민공원</span></div>
<div class="station" data-station="석바위시장"><span>석바위시장</span></div>
<div class="station" data-station="인천시청"><span>인천시청</span><small>(GTX-B)</small></div>
<div class="station" data-station="석천사거리"><span>석천사거리</span></div>
<div class="station" data-station="모래내시장"><span>모래내시장</span></div>
<div class="station" data-station="만수"><span>만수</span></div>
<div class="station" data-station="남동구청"><span>남동구청</span></div>
<div class="station" data-station="인천대공원"><span>인천대공원</span></div>
<div class="station" data-station="운연"><span>운연</span></div>
</div>
<!-- 서해선 노선도 -->
<div class="stations seohae-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="일산"><span>일산</span></div>
<div class="station" data-station="풍산"><span>풍산</span></div>
<div class="station" data-station="백마"><span>백마</span></div>
<div class="station" data-station="곡산"><span>곡산</span></div>
<div class="station" data-station="대곡"><span>대곡</span><small>(3호선, GTX-A)</small></div>
<div class="station" data-station="능곡"><span>능곡</span></div>
<div class="station" data-station="김포공항"><span>김포공항</span><small>(공항철도)</small></div>
<div class="station" data-station="원종"><span>원종</span></div>
<div class="station" data-station="부천종합운동장"><span>부천종합운동장</span></div>
<div class="station" data-station="소사"><span>소사</span></div>
<div class="station" data-station="소새울"><span>소새울</span></div>
<div class="station" data-station="시흥대야"><span>시흥대야</span></div>
<div class="station" data-station="신천"><span>신천</span></div>
<div class="station" data-station="신현"><span>신현</span></div>
<div class="station" data-station="시흥시청"><span>시흥시청</span></div>
<div class="station" data-station="시흥능곡"><span>시흥능곡</span></div>
<div class="station" data-station="달미"><span>달미</span></div>
<div class="station" data-station="선부"><span>선부</span></div>
<div class="station" data-station="초지"><span>초지</span></div>
<div class="station" data-station="시우"><span>시우</span></div>
<div class="station" data-station="원시"><span>원시</span></div>
</div>

<!-- 김포골드라인 노선도 -->
<div class="stations gimpo-stations" data-original-order="normal" style="display: none;">
<div class="station" data-station="김포공항"><span>김포공항</span><small>(5호선, 9호선, 공항철도, 서해선)</small></div>
<div class="station" data-station="고촌"><span>고촌</span></div>
<div class="station" data-station="풍무"><span>풍무</span></div>
<div class="station" data-station="사우"><span>사우</span></div>
<div class="station" data-station="걸포북변"><span>걸포북변</span></div>
<div class="station" data-station="운양"><span>운양</span></div>
<div class="station" data-station="장기"><span>장기</span></div>
<div class="station" data-station="마산"><span>마산</span></div>
<div class="station" data-station="구래"><span>구래</span></div>
<div class="station" data-station="양촌"><span>양촌</span></div>
</div>

<!-- 공항철도 노선도 -->
<div class="stations airport-stations" data-original-order="normal" style="display: none;">
  <div class="station" data-station="서울역"><span>서울역</span><small>(1호선, 4호선, 공항철도, KTX, ITX, SRT, GTX-A)</small></div>
<div class="station" data-station="공덕"><span>공덕</span></div>
<div class="station" data-station="홍대입구"><span>홍대입구</span></div>
<div class="station" data-station="디지털미디어시티"><span>디지털미디어시티</span></div>
<div class="station" data-station="마곡나루"><span>마곡나루</span></div>
<div class="station" data-station="김포공항"><span>김포공항</span></div>
<div class="station" data-station="계양"><span>계양</span></div>
<div class="station" data-station="검암"><span>검암</span></div>
<div class="station" data-station="청라국제도시"><span>청라국제도시</span></div>
<div class="station" data-station="영종"><span>영종</span></div>
<div class="station" data-station="운서"><span>운서</span></div>
<div class="station" data-station="공항화물청사"><span>공항화물청사</span></div>
<div class="station" data-station="인천공항1터미널"><span>인천공항1터미널</span></div>
<div class="station" data-station="인천공항2터미널"><span>인천공항2터미널</span></div>
</div>
</div>
</section>

<!-- 실시간 도착정보 섹션 -->
<section id="realtime">
  <div class="realtime-top">
    <label for="stationInput">역 이름 (자연어 검색 지원)</label>
    <input id="stationInput" placeholder="예: 공덕역 가고 싶어, 2호선 강남역 상행, 왕십리" />
    <button id="stationApply">실시간 보기</button>
    <span id="lastUpdated" aria-live="polite"></span>
  </div>
  <ul id="arrivalList" class="arrival-list"></ul>
</section>

<!-- 왼쪽 지하철 노선 목록 -->
<div class="subway-lines">
<h3>지하철 노선</h3>
<div class="line-list">
<div class="line-item line-1 active">1호선</div>
<div class="line-item line-2">2호선</div>
<div class="line-item line-2-seongsu">2호선 성수지선</div>
<div class="line-item line-2-sinjeong">2호선 신정지선</div>
<div class="line-item line-3">3호선</div>
<div class="line-item line-4">4호선</div>
<div class="line-item line-5">5호선</div>
<div class="line-item line-6">6호선</div>
<div class="line-item line-7">7호선</div>
<div class="line-item line-8">8호선</div>
<div class="line-item line-9">9호선</div>
<div class="line-item line-sinbundang">신분당선</div>
<div class="line-item line-gyeongui-jungang">경의중앙선</div>
<div class="line-item line-gyeongchun">경춘선</div>
<div class="line-item line-bundang">분당선</div>
<div class="line-item line-airport">공항철도</div>
<div class="line-item line-gimpo">김포골드라인</div>
<div class="line-item line-gtx-a">GTX-A</div>
<div class="line-item line-ui-sinseol">우이신설선</div>
<div class="line-item line-sillim">신림선</div>
<div class="line-item line-uijeongbu">의정부경전철</div>
<div class="line-item line-yongin-everline">용인에버라인</div>
<div class="line-item line-gyeonggang">경강선</div>
<div class="line-item line-incheon1">인천1호선</div>
<div class="line-item line-incheon2">인천2호선</div>
<div class="line-item line-seohae">서해선</div>
</div>
</div>
<!-- 왼쪽 상단 실시간 시계 (시:분) -->
<div aria-label="현재 시각" class="clock" id="clock"></div>

<!-- 방향 선택 버튼 (시계 밑) -->
<div class="direction-container">
  <h3>방향 선택</h3>
  <div class="direction-box">
    <label><input checked="" name="dir" type="radio" value="up"/> 상행</label>
    <label><input name="dir" type="radio" value="down"/> 하행</label>
  </div>
  <div id="api-status" style="margin-top: 10px; font-size: 0.9rem; font-weight: bold;">🟢 API 연결 중</div>
  <button id="api-test-btn" style="margin-top: 5px; padding: 5px 10px; font-size: 0.8rem; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer;">API 테스트</button>
</div>
<!-- 시계 및 실시간 도착정보 스크립트 -->
<script>
    // 시계 업데이트
    function pad(n){ return n.toString().padStart(2, '0'); }
    function updateClock(){
      const now = new Date();
      const hh = pad(now.getHours());
      const mi = pad(now.getMinutes());
      document.getElementById('clock').textContent = `${hh}:${mi}`;
    }
    updateClock();
    setInterval(updateClock, 1000);

    // 실제 API 사용을 위한 설정
    const API_CONFIG = {
      // 공공데이터포털에서 발급받은 인증키를 여기에 입력하세요
      // 1. https://data.go.kr 접속
      // 2. 회원가입 후 로그인
      // 3. '서울특별시_지하철 실시간 도착정보' API 신청
      // 4. 발급받은 인증키를 아래에 입력
      API_KEY: '4974716f4269746f3738566c474c46',
      // 서울시 지하철 실시간 도착정보 API URL (검증된 형식)
      API_URL: 'http://swopenapi.seoul.go.kr/api/subway/4974716f4269746f3738566c474c46/json/realtimeStationArrival/0/5/',
      // 공덕역 코드 (5호선)
      STATION_CODE: '0527'
    };

    // 실시간 도착정보 시뮬레이션 (API 사용 전까지)
    const stations = [
      { name: "공덕역", arrivals: [3, 9, 16] },
      { name: "애오개역", arrivals: [1, 7, 14] },
      { name: "충정로역", arrivals: [2, 8, 15] },
      { name: "서대문역", arrivals: [4, 10, 17] }
    ];

    // 1호선 모든 역의 도착 정보 데이터 (정확한 순서)
    const line1StationData = {
      "연천": { arrivals: [1, 5] },
      "전곡": { arrivals: [2, 6] },
      "청산": { arrivals: [3, 7] },
      "소요산": { arrivals: [1, 5] },
      "동두천": { arrivals: [2, 6] },
      "보산": { arrivals: [3, 7] },
      "동두천중앙": { arrivals: [1, 5] },
      "지행": { arrivals: [2, 6] },
      "덕정": { arrivals: [3, 7] },
      "덕계": { arrivals: [1, 5] },
      "양주": { arrivals: [2, 6] },
      "녹양": { arrivals: [3, 7] },
      "가능": { arrivals: [1, 5] },
      "의정부": { arrivals: [2, 6] },
      "회룡": { arrivals: [3, 7] },
      "망월사": { arrivals: [1, 5] },
      "도봉산": { arrivals: [2, 6] },
      "도봉": { arrivals: [3, 7] },
      "방학": { arrivals: [1, 5] },
      "창동": { arrivals: [2, 6] },
      "녹천": { arrivals: [3, 7] },
      "월계": { arrivals: [1, 5] },
      "광운대": { arrivals: [2, 6] },
      "석계": { arrivals: [3, 7] },
      "신이문": { arrivals: [1, 5] },
      "외대앞": { arrivals: [2, 6] },
      "회기": { arrivals: [3, 7] },
      "청량리": { arrivals: [1, 5] },
      "제기동": { arrivals: [2, 6] },
      "신설동": { arrivals: [3, 7] },
      "동묘앞": { arrivals: [1, 5] },
      "동대문": { arrivals: [2, 6] },
      "종로5가": { arrivals: [3, 7] },
      "종로3가": { arrivals: [1, 5] },
      "종각": { arrivals: [2, 6] },
      "시청": { arrivals: [3, 7] },
      "서울역": { arrivals: [1, 5] },
      "남영": { arrivals: [2, 6] },
      "용산": { arrivals: [3, 7] },
      "노량진": { arrivals: [1, 5] },
      "대방": { arrivals: [2, 6] },
      "신길": { arrivals: [3, 7] },
      "영등포": { arrivals: [1, 5] },
      "신도림": { arrivals: [2, 6] },
      "구로": { arrivals: [3, 7] },
      "가산디지털단지": { arrivals: [1, 5] },
      "독산": { arrivals: [2, 6] },
      "금천구청": { arrivals: [3, 7] },
      "석수": { arrivals: [1, 5] },
      "관악": { arrivals: [2, 6] },
      "안양": { arrivals: [3, 7] },
      "명학": { arrivals: [1, 5] },
      "금정": { arrivals: [2, 6] },
      "군포": { arrivals: [3, 7] },
      "당정": { arrivals: [1, 5] },
      "의왕": { arrivals: [2, 6] },
      "성균관대": { arrivals: [3, 7] },
      "화서": { arrivals: [1, 5] },
      "수원": { arrivals: [2, 6] },
      "세류": { arrivals: [3, 7] },
      "병점": { arrivals: [1, 5] },
      "세마": { arrivals: [2, 6] },
      "오산대": { arrivals: [3, 7] },
      "오산": { arrivals: [1, 5] },
      "진위": { arrivals: [2, 6] },
      "송탄": { arrivals: [3, 7] },
      "서정리": { arrivals: [1, 5] },
      "평택지제": { arrivals: [2, 6] },
      "평택": { arrivals: [3, 7] },
      "성환": { arrivals: [1, 5] },
      "직산": { arrivals: [2, 6] },
      "두정": { arrivals: [3, 7] },
      "천안": { arrivals: [1, 5] },
      "봉명": { arrivals: [2, 6] },
      "쌍용": { arrivals: [3, 7] },
      "아산": { arrivals: [1, 5] },
      "탕정": { arrivals: [2, 6] },
      "배방": { arrivals: [3, 7] },
      "온양온천": { arrivals: [1, 5] },
      "신창": { arrivals: [2, 6] },
      "광명": { arrivals: [3, 7] },
      "서동탄": { arrivals: [1, 5] }
    };

    // 2호선 본선 역 데이터 (순환선)
    const line2MainStationData = {
      "시청": { arrivals: [1, 5] },
      "을지로입구": { arrivals: [2, 6] },
      "을지로3가": { arrivals: [3, 7] },
      "을지로4가": { arrivals: [1, 5] },
      "동대문역사문화공원": { arrivals: [2, 6] },
      "신당": { arrivals: [3, 7] },
      "상왕십리": { arrivals: [1, 5] },
      "왕십리": { arrivals: [2, 6] },
      "한양대": { arrivals: [3, 7] },
      "뚝섬": { arrivals: [1, 5] },
      "성수": { arrivals: [2, 6] },
      "건대입구": { arrivals: [3, 7] },
      "구의": { arrivals: [1, 5] },
      "강변": { arrivals: [2, 6] },
      "잠실나루": { arrivals: [3, 7] },
      "잠실": { arrivals: [1, 5] },
      "잠실새내": { arrivals: [2, 6] },
      "종합운동장": { arrivals: [3, 7] },
      "삼성": { arrivals: [1, 5] },
      "선릉": { arrivals: [2, 6] },
      "역삼": { arrivals: [3, 7] },
      "강남": { arrivals: [1, 5] },
      "교대": { arrivals: [2, 6] },
      "서초": { arrivals: [3, 7] },
      "방배": { arrivals: [1, 5] },
      "사당": { arrivals: [2, 6] },
      "낙성대": { arrivals: [3, 7] },
      "서울대입구": { arrivals: [1, 5] },
      "봉천": { arrivals: [2, 6] },
      "신림": { arrivals: [3, 7] },
      "신대방": { arrivals: [1, 5] },
      "구로디지털단지": { arrivals: [2, 6] },
      "대림": { arrivals: [3, 7] },
      "신도림": { arrivals: [1, 5] },
      "문래": { arrivals: [2, 6] },
      "영등포구청": { arrivals: [3, 7] },
      "당산": { arrivals: [1, 5] },
      "합정": { arrivals: [2, 6] },
      "홍대입구": { arrivals: [3, 7] },
      "신촌": { arrivals: [1, 5] },
      "이대": { arrivals: [2, 6] },
      "아현": { arrivals: [3, 7] },
      "충정로": { arrivals: [1, 5] }
    };

    // 2호선 성수지선 역 데이터
    const line2SeongsuStationData = {
      "성수": { arrivals: [1, 5], transfers: ['2호선 본선'] },
      "용답": { arrivals: [2, 6] },
      "신답": { arrivals: [3, 7] },
      "용두": { arrivals: [1, 5] },
      "신설동": { arrivals: [2, 6], transfers: ['1호선', '우이신설선'] }
    };

    // 2호선 신정지선 역 데이터
    const line2SinjeongStationData = {
      "신도림": { arrivals: [1, 5], transfers: ['1호선', '2호선 본선'] },
      "도림천": { arrivals: [2, 6] },
      "양천구청": { arrivals: [3, 7] },
      "신정네거리": { arrivals: [1, 5] },
      "까치산": { arrivals: [2, 6], transfers: ['5호선'] }
    };

    // 3호선 모든 역의 도착 정보 데이터 (2개 열차만)
    const line3StationData = {
      "대화": { arrivals: [3, 9] },
      "주엽": { arrivals: [1, 6] },
      "정발산": { arrivals: [3, 8] },
      "마두": { arrivals: [2, 7] },
      "백석": { arrivals: [4, 9] },
      "대곡": { arrivals: [1, 6] },
      "화정": { arrivals: [3, 8] },
      "원당": { arrivals: [2, 7] },
      "원흥": { arrivals: [4, 9] },
      "삼송": { arrivals: [1, 6] },
      "지축": { arrivals: [3, 8] },
      "구파발": { arrivals: [2, 7] },
      "연신내": { arrivals: [4, 9] },
      "불광": { arrivals: [1, 6] },
      "녹번": { arrivals: [3, 8] },
      "홍제": { arrivals: [2, 7] },
      "무악재": { arrivals: [4, 9] },
      "독립문": { arrivals: [1, 6] },
      "경복궁": { arrivals: [3, 8] },
      "안국": { arrivals: [2, 7] },
      "종로3가": { arrivals: [4, 9] },
      "을지로3가": { arrivals: [1, 6] },
      "충무로": { arrivals: [3, 8] },
      "동대입구": { arrivals: [2, 7] },
      "약수": { arrivals: [4, 9] },
      "금호": { arrivals: [1, 6] },
      "옥수": { arrivals: [3, 8] },
      "압구정": { arrivals: [2, 7] },
      "신사": { arrivals: [4, 9] },
      "잠원": { arrivals: [1, 6] },
      "고속터미널": { arrivals: [3, 8] },
      "교대": { arrivals: [2, 7] },
      "남부터미널": { arrivals: [4, 9] },
      "양재": { arrivals: [1, 6] },
      "매봉": { arrivals: [3, 8] },
      "도곡": { arrivals: [2, 7] },
      "대치": { arrivals: [4, 9] },
      "학여울": { arrivals: [1, 6] },
      "대청": { arrivals: [3, 8] },
      "일원": { arrivals: [2, 7] },
      "수서": { arrivals: [4, 9] },
      "가락시장": { arrivals: [1, 6] },
      "경찰병원": { arrivals: [3, 8] },
      "오금": { arrivals: [2, 7] }
    };

    // 4호선 모든 역의 도착 정보 데이터 (2개 열차만)
    const line4StationData = {
      "당고개": { arrivals: [4, 11] },
      "상계": { arrivals: [1, 6] },
      "노원": { arrivals: [3, 8] },
      "창동": { arrivals: [2, 7] },
      "쌍문": { arrivals: [4, 9] },
      "수유": { arrivals: [1, 6] },
      "미아": { arrivals: [3, 8] },
      "미아사거리": { arrivals: [2, 7] },
      "길음": { arrivals: [4, 9] },
      "성신여대입구": { arrivals: [1, 6] },
      "한성대입구": { arrivals: [3, 8] },
      "혜화": { arrivals: [2, 7] },
      "동대문": { arrivals: [4, 9] },
      "동대문역사문화공원": { arrivals: [1, 6] },
      "충무로": { arrivals: [3, 8] },
      "명동": { arrivals: [2, 7] },
      "회현": { arrivals: [4, 9] },
      "서울역": { arrivals: [1, 6] },
      "숙대입구": { arrivals: [3, 8] },
      "삼각지": { arrivals: [2, 7] },
      "신용산": { arrivals: [4, 9] },
      "이촌": { arrivals: [1, 6] },
      "동작": { arrivals: [3, 8] },
      "총신대입구": { arrivals: [2, 7] },
      "사당": { arrivals: [4, 9] },
      "남태령": { arrivals: [1, 6] },
      "선바위": { arrivals: [3, 8] },
      "경마공원": { arrivals: [2, 7] },
      "대공원": { arrivals: [4, 9] },
      "과천": { arrivals: [1, 6] },
      "정부과천청사": { arrivals: [3, 8] },
      "인덕원": { arrivals: [2, 7] },
      "평촌": { arrivals: [4, 9] },
      "범계": { arrivals: [1, 6] },
      "금정": { arrivals: [3, 8] },
      "산본": { arrivals: [2, 7] },
      "수리산": { arrivals: [4, 9] },
      "대야미": { arrivals: [1, 6] },
      "반월": { arrivals: [3, 8] },
      "상록수": { arrivals: [2, 7] },
      "한대앞": { arrivals: [4, 9] },
      "중앙": { arrivals: [1, 6] },
      "고잔": { arrivals: [3, 8] },
      "초지": { arrivals: [2, 7] },
      "안산": { arrivals: [4, 9] },
      "신길온천": { arrivals: [1, 6] },
      "정왕": { arrivals: [3, 8] },
      "오이도": { arrivals: [2, 7] }
    };

    // 5호선 모든 역의 도착 정보 데이터 (정확한 순서)
    const line5StationData = {
      "방화": { arrivals: [1, 5] },
      "개화산": { arrivals: [2, 6] },
      "김포공항": { arrivals: [3, 7] },
      "송정": { arrivals: [1, 5] },
      "마곡": { arrivals: [2, 6] },
      "발산": { arrivals: [3, 7] },
      "우장산": { arrivals: [1, 5] },
      "화곡": { arrivals: [2, 6] },
      "까치산": { arrivals: [3, 7] },
      "신정": { arrivals: [1, 5] },
      "목동": { arrivals: [2, 6] },
      "오목교": { arrivals: [3, 7] },
      "양평": { arrivals: [1, 5] },
      "영등포구청": { arrivals: [2, 6] },
      "영등포시장": { arrivals: [3, 7] },
      "신길": { arrivals: [1, 5] },
      "여의도": { arrivals: [2, 6] },
      "여의나루": { arrivals: [3, 7] },
      "마포": { arrivals: [1, 5] },
      "애오개": { arrivals: [2, 6] },
      "충정로": { arrivals: [3, 7] },
      "서대문": { arrivals: [1, 5] },
      "광화문": { arrivals: [2, 6] },
      "종로3가": { arrivals: [3, 7] },
      "을지로4가": { arrivals: [1, 5] },
      "동대문운동장": { arrivals: [2, 6] },
      "청구": { arrivals: [3, 7] },
      "신금호": { arrivals: [1, 5] },
      "행당": { arrivals: [2, 6] },
      "왕십리": { arrivals: [3, 7] },
      "마장": { arrivals: [1, 5] },
      "답십리": { arrivals: [2, 6] },
      "장한평": { arrivals: [3, 7] },
      "군자": { arrivals: [1, 5] },
      "아차산": { arrivals: [2, 6] },
      "광나루": { arrivals: [3, 7] },
      "천호": { arrivals: [1, 5] },
      "강동": { arrivals: [2, 6] },
      "길동": { arrivals: [3, 7] },
      "굽은다리": { arrivals: [1, 5] },
      "명일": { arrivals: [2, 6] },
      "고덕": { arrivals: [3, 7] },
      "상일동": { arrivals: [1, 5] },
      "강일": { arrivals: [2, 6] },
      "미사": { arrivals: [3, 7] },
      "하남풍산": { arrivals: [1, 5] },
      "하남시청": { arrivals: [2, 6] },
      "하남검단산": { arrivals: [3, 7] }
    };

    // 6호선 모든 역의 도착 정보 데이터 (2개 열차만)
    const line6StationData = {
      "응암": { arrivals: [5, 12] },
      "역촌": { arrivals: [1, 6] },
      "불광": { arrivals: [3, 8] },
      "독바위": { arrivals: [2, 7] },
      "연신내": { arrivals: [4, 9] },
      "구산": { arrivals: [1, 6] },
      "새절": { arrivals: [3, 8] },
      "증산": { arrivals: [2, 7] },
      "디지털미디어시티": { arrivals: [4, 9] },
      "월드컵경기장": { arrivals: [1, 6] },
      "마포구청": { arrivals: [3, 8] },
      "망원": { arrivals: [2, 7] },
      "합정": { arrivals: [4, 9] },
      "상수": { arrivals: [1, 6] },
      "광흥창": { arrivals: [3, 8] },
      "대흥": { arrivals: [2, 7] },
      "효창공원앞": { arrivals: [1, 6] },
      "삼각지": { arrivals: [3, 8] },
      "녹사평": { arrivals: [2, 7] },
      "이태원": { arrivals: [4, 9] },
      "한강진": { arrivals: [1, 6] },
      "버티고개": { arrivals: [3, 8] },
      "약수": { arrivals: [2, 7] },
      "청구": { arrivals: [4, 9] },
      "신당": { arrivals: [1, 6] },
      "동묘앞": { arrivals: [3, 8] },
      "창신": { arrivals: [2, 7] },
      "보문": { arrivals: [4, 9] },
      "안암": { arrivals: [1, 6] },
      "고려대": { arrivals: [3, 8] },
      "월곡": { arrivals: [2, 7] },
      "상월곡": { arrivals: [4, 9] },
      "돌곶이": { arrivals: [1, 6] },
      "석계": { arrivals: [3, 8] },
      "태릉입구": { arrivals: [2, 7] },
      "화랑대": { arrivals: [4, 9] },
      "봉화산": { arrivals: [1, 6] },
      "신내": { arrivals: [3, 8] }
    };

    // 7호선 모든 역의 도착 정보 데이터 (2개 열차만)
    const line7StationData = {
      "석남": { arrivals: [2, 7] },
      "도봉산": { arrivals: [1, 6] },
      "수락산": { arrivals: [3, 8] },
      "마들": { arrivals: [2, 7] },
      "노원": { arrivals: [4, 9] },
      "중계": { arrivals: [1, 6] },
      "하계": { arrivals: [3, 8] },
      "공릉": { arrivals: [2, 7] },
      "태릉입구": { arrivals: [4, 9] },
      "먹골": { arrivals: [1, 6] },
      "중화": { arrivals: [3, 8] },
      "상봉": { arrivals: [2, 7] },
      "면목": { arrivals: [4, 9] },
      "사가정": { arrivals: [1, 6] },
      "용마산": { arrivals: [3, 8] },
      "중곡": { arrivals: [2, 7] },
      "군자": { arrivals: [4, 9] },
      "어린이대공원": { arrivals: [1, 6] },
      "건대입구": { arrivals: [3, 8] },
      "뚝섬유원지": { arrivals: [2, 7] },
      "청담": { arrivals: [4, 9] },
      "강남구청": { arrivals: [1, 6] },
      "학동": { arrivals: [3, 8] },
      "논현": { arrivals: [2, 7] },
      "반포": { arrivals: [4, 9] },
      "고속터미널": { arrivals: [1, 6] },
      "내방": { arrivals: [3, 8] },
      "총신대입구": { arrivals: [2, 7] },
      "남성": { arrivals: [4, 9] },
      "숭실대입구": { arrivals: [1, 6] },
      "상도": { arrivals: [3, 8] },
      "장승배기": { arrivals: [2, 7] },
      "신대방삼거리": { arrivals: [4, 9] },
      "보라매": { arrivals: [1, 6] },
      "신풍": { arrivals: [3, 8] },
      "대림": { arrivals: [2, 7] },
      "남구로": { arrivals: [4, 9] },
      "가산디지털단지": { arrivals: [1, 6] },
      "철산": { arrivals: [3, 8] },
      "광명사거리": { arrivals: [2, 7] },
      "천왕": { arrivals: [4, 9] },
      "온수": { arrivals: [1, 6] },
      "까치울": { arrivals: [3, 8] },
      "부천종합운동장": { arrivals: [2, 7] },
      "춘의": { arrivals: [4, 9] },
      "신중동": { arrivals: [1, 6] },
      "부천시청": { arrivals: [3, 8] },
      "상동": { arrivals: [2, 7] },
      "삼산체육관": { arrivals: [4, 9] },
      "굴포천": { arrivals: [1, 6] },
      "부평구청": { arrivals: [3, 8] },
      "산곡": { arrivals: [2, 7] }
    };

    // 8호선 모든 역의 도착 정보 데이터 (2개 열차만)
    const line8StationData = {
      "모란": { arrivals: [2, 7] },
      "천호": { arrivals: [1, 6] },
      "강동구청": { arrivals: [3, 8] },
      "몽촌토성": { arrivals: [2, 7] },
      "잠실": { arrivals: [4, 9] },
      "석촌": { arrivals: [1, 6] },
      "송파": { arrivals: [3, 8] },
      "가락시장": { arrivals: [2, 7] },
      "문정": { arrivals: [4, 9] },
      "장지": { arrivals: [1, 6] },
      "복정": { arrivals: [3, 8] },
      "남위례": { arrivals: [2, 7] },
      "산성": { arrivals: [4, 9] },
      "남한산성입구": { arrivals: [1, 6] },
      "단대오거리": { arrivals: [3, 8] },
      "신흥": { arrivals: [2, 7] },
      "수진": { arrivals: [4, 9] }
    };

    // 9호선 모든 역의 도착 정보 데이터 (2개 열차만)
    const line9StationData = {
      "개화": { arrivals: [2, 7] },
      "김포공항": { arrivals: [1, 6] },
      "공항시장": { arrivals: [3, 8] },
      "신방화": { arrivals: [2, 7] },
      "마곡나루": { arrivals: [4, 9] },
      "양천향교": { arrivals: [1, 6] },
      "가양": { arrivals: [3, 8] },
      "증미": { arrivals: [2, 7] },
      "등촌": { arrivals: [4, 9] },
      "염창": { arrivals: [1, 6] },
      "신목동": { arrivals: [3, 8] },
      "선유도": { arrivals: [2, 7] },
      "당산": { arrivals: [4, 9] },
      "국회의사당": { arrivals: [1, 6] },
      "여의도": { arrivals: [3, 8] },
      "샛강": { arrivals: [2, 7] },
      "노들": { arrivals: [4, 9] },
      "흑석": { arrivals: [1, 6] },
      "동작": { arrivals: [3, 8] },
      "구반포": { arrivals: [2, 7] },
      "신반포": { arrivals: [4, 9] },
      "고속터미널": { arrivals: [1, 6] },
      "사평": { arrivals: [3, 8] },
      "신논현": { arrivals: [2, 7] },
      "언주": { arrivals: [4, 9] },
      "선정릉": { arrivals: [1, 6] },
      "삼성중앙": { arrivals: [3, 8] },
      "봉은사": { arrivals: [2, 7] },
      "종합운동장": { arrivals: [4, 9] },
      "삼전": { arrivals: [1, 6] },
      "석촌고분": { arrivals: [3, 8] },
      "석촌": { arrivals: [2, 7] },
      "송파나루": { arrivals: [4, 9] },
      "한성백제": { arrivals: [1, 6] },
      "올림픽공원": { arrivals: [3, 8] },
      "둔촌오륜": { arrivals: [2, 7] },
      "중앙보훈병원": { arrivals: [4, 9] }
    };

    // 신분당선 역 데이터 (정확한 순서와 역명)
    const shinbundangStationData = {
      '신사': { arrivals: [1, 5] },
      '논현': { arrivals: [2, 6] },
      '신논현': { arrivals: [3, 7] },
      '강남': { arrivals: [1, 5] },
      '양재': { arrivals: [2, 6] },
      '양재시민의숲': { arrivals: [3, 7] },
      '청계산입구': { arrivals: [1, 5] },
      '판교': { arrivals: [2, 6] },
      '정자': { arrivals: [3, 7] },
      '미금': { arrivals: [1, 5] },
      '동천': { arrivals: [2, 6] },
      '수지구청': { arrivals: [3, 7] },
      '성복': { arrivals: [1, 5] },
      '상현': { arrivals: [2, 6] },
      '광교중앙': { arrivals: [3, 7] },
      '광교': { arrivals: [1, 5] }
    };

    // 경의선 역 데이터 (도라산역 ~ 서울역)
    // ✅ 경의·중앙선(통합) 데이터
const gyeonguiJungangStationData = {
  '문산': { arrivals: [1, 5] }, '파주': { arrivals: [2, 6] }, '월롱': { arrivals: [3, 7] },
  '금촌': { arrivals: [1, 5] }, '금릉': { arrivals: [2, 6] }, '운정': { arrivals: [3, 7] },
  '야당': { arrivals: [1, 5] }, '탄현': { arrivals: [2, 6] }, '일산': { arrivals: [3, 7] },
  '풍산': { arrivals: [1, 5] }, '백마': { arrivals: [2, 6] }, '곡산': { arrivals: [3, 7] },
  '대곡': { arrivals: [1, 5] }, '능곡': { arrivals: [2, 6] }, '행신': { arrivals: [3, 7] },
  '강매': { arrivals: [1, 5] }, '화전': { arrivals: [2, 6] }, '수색': { arrivals: [3, 7] },
  '디지털미디어시티': { arrivals: [1, 5] }, '가좌': { arrivals: [2, 6] },
  '홍대입구': { arrivals: [3, 7] }, '신촌': { arrivals: [1, 5] }, '서울역': { arrivals: [2, 6] }, '공덕': { arrivals: [3, 7] },
  '효창공원앞': { arrivals: [1, 5] }, '용산': { arrivals: [2, 6] }, '이촌': { arrivals: [3, 7] },
  '서빙고': { arrivals: [1, 5] }, '한남': { arrivals: [2, 6] }, '옥수': { arrivals: [3, 7] },
  '응봉': { arrivals: [1, 5] }, '왕십리': { arrivals: [2, 6] }, '청량리': { arrivals: [3, 7] },
  '회기': { arrivals: [1, 5] }, '중랑': { arrivals: [2, 6] }, '상봉': { arrivals: [3, 7] },
  '망우': { arrivals: [1, 5] }, '양원': { arrivals: [2, 6] }, '구리': { arrivals: [3, 7] },
  '도농': { arrivals: [1, 5] }, '양정': { arrivals: [2, 6] }, '덕소': { arrivals: [3, 7] },
  '도심': { arrivals: [1, 5] }, '팔당': { arrivals: [2, 6] }, '운길산': { arrivals: [3, 7] },
  '양수': { arrivals: [1, 5] }, '신원': { arrivals: [2, 6] }, '국수': { arrivals: [3, 7] },
  '아신': { arrivals: [1, 5] }, '오빈': { arrivals: [2, 6] }, '양평': { arrivals: [3, 7] },
  '원덕': { arrivals: [1, 5] }, '용문': { arrivals: [2, 6] }, '지평': { arrivals: [3, 7] }
};


    // GTX-A 역 데이터
    const gtxAStationData = {
      '운정': { arrivals: [2, 8] },
      '킨텍스': { arrivals: [3, 9] },
      '대곡': { arrivals: [1, 7] },
      '연신내': { arrivals: [4, 10] },
      '서울역': { arrivals: [2, 8] },
      '삼성': { arrivals: [3, 9] },
      '수서': { arrivals: [1, 7] },
      '성남': { arrivals: [4, 10] },
      '용인': { arrivals: [2, 8] },
      '동탄': { arrivals: [3, 9] }
    };

    // 우이신설선 역 데이터
    const uiSinseolStationData = {
      '신설동': { arrivals: [1, 5] },
      '보문': { arrivals: [2, 6] },
      '성신여대입구': { arrivals: [3, 7] },
      '정릉': { arrivals: [1, 5] },
      '북한산보국문': { arrivals: [2, 6] },
      '솔샘': { arrivals: [3, 7] },
      '삼양사거리': { arrivals: [1, 5] },
      '삼양': { arrivals: [2, 6] },
      '화계': { arrivals: [3, 7] },
      '가오리': { arrivals: [1, 5] },
      '4.19민주묘지': { arrivals: [2, 6] },
      '솔밭공원': { arrivals: [3, 7] },
      '북한산우이': { arrivals: [1, 5] }
    };

    // 신림선 역 데이터
    const sillimStationData = {
      '신림': { arrivals: [1, 5], transfers: ['2호선'] },
      '샛강': { arrivals: [2, 6] },
      '대방': { arrivals: [3, 7] },
      '서울지방병무청': { arrivals: [1, 5] },
      '보라매': { arrivals: [2, 6] },
      '보라매공원': { arrivals: [3, 7] },
      '보라매병원': { arrivals: [1, 5] },
      '당곡': { arrivals: [2, 6] },
      '서원': { arrivals: [1, 5] },
      '서울대벤처타운': { arrivals: [2, 6] },
      '관악산': { arrivals: [3, 7] }
    };

    // 의정부경전철 역 데이터
    const uijeongbuStationData = {
      '발곡': { arrivals: [1, 5] },
      '회룡': { arrivals: [2, 6], transfers: ['1호선'] },
      '범골': { arrivals: [3, 7] },
      '경전철의정부': { arrivals: [1, 5] },
      '의정부시청': { arrivals: [2, 6] },
      '흥선': { arrivals: [3, 7] },
      '의정부중앙': { arrivals: [1, 5] },
      '동오': { arrivals: [2, 6] },
      '새말': { arrivals: [3, 7] },
      '경기도청북부청사': { arrivals: [1, 5] },
      '효자': { arrivals: [2, 6] },
      '곤제': { arrivals: [3, 7] },
      '어룡': { arrivals: [1, 5] },
      '송산': { arrivals: [2, 6] },
      '탑석': { arrivals: [3, 7] },
      '차량기지임시승강장': { arrivals: [1, 5] }
    };

    // 용인에버라인 역 데이터
    const yonginEverlineStationData = {
      '용인': { arrivals: [1, 5] },
      '기흥': { arrivals: [2, 6], transfers: ['분당선'] },
      '강남대': { arrivals: [3, 7] },
      '지석': { arrivals: [1, 5] },
      '어정': { arrivals: [2, 6] },
      '동백': { arrivals: [3, 7] },
      '초당': { arrivals: [1, 5] },
      '삼가': { arrivals: [2, 6] },
      '시청·용인대': { arrivals: [3, 7] },
      '명지대': { arrivals: [1, 5] },
      '김량장': { arrivals: [2, 6] },
      '운동장·송담대': { arrivals: [3, 7] },
      '고진': { arrivals: [1, 5] },
      '보평': { arrivals: [2, 6] },
      '둔전': { arrivals: [3, 7] },
      '전대·에버랜드': { arrivals: [1, 5] }
    };

    // 분당선 역 데이터
    const bundangStationData = {
      '청량리': { arrivals: [1, 5] },
      '왕십리': { arrivals: [2, 6] },
      '서울숲': { arrivals: [3, 7] },
      '압구정로데오': { arrivals: [1, 5] },
      '강남구청': { arrivals: [2, 6] },
      '선정릉': { arrivals: [3, 7] },
      '선릉': { arrivals: [1, 5] },
      '한티': { arrivals: [2, 6] },
      '도곡': { arrivals: [3, 7] },
      '구룡': { arrivals: [1, 5] },
      '개포동': { arrivals: [2, 6] },
      '대모산입구': { arrivals: [3, 7] },
      '수서': { arrivals: [1, 5] },
      '복정': { arrivals: [2, 6] },
      '가천대': { arrivals: [3, 7] },
      '태평': { arrivals: [1, 5] },
      '모란': { arrivals: [2, 6] },
      '야탑': { arrivals: [3, 7] },
      '이매': { arrivals: [1, 5] },
      '서현': { arrivals: [2, 6] },
      '수내': { arrivals: [3, 7] },
      '정자': { arrivals: [1, 5] },
      '미금': { arrivals: [2, 6] },
      '오리': { arrivals: [3, 7] },
      '죽전': { arrivals: [1, 5] },
      '보정': { arrivals: [2, 6] },
      '구성': { arrivals: [3, 7] },
      '신갈': { arrivals: [1, 5] },
      '기흥': { arrivals: [2, 6] },
      '상갈': { arrivals: [3, 7] },
      '청명': { arrivals: [1, 5] },
      '영통': { arrivals: [2, 6] },
      '망포': { arrivals: [3, 7] },
      '매탄권선': { arrivals: [1, 5] },
      '수원시청': { arrivals: [2, 6] },
      '매교': { arrivals: [3, 7] },
      '수원': { arrivals: [1, 5] }
    };

    // 경춘선 역 데이터
    const gyeongchunStationData = {
      '청량리': { arrivals: [1, 5] },
      '회기': { arrivals: [2, 6] },
      '중랑': { arrivals: [3, 7] },
      '상봉': { arrivals: [1, 5] },
      '망우': { arrivals: [2, 6] },
      '신내': { arrivals: [3, 7] },
      '갈매': { arrivals: [1, 5] },
      '별내': { arrivals: [2, 6] },
      '퇴계원': { arrivals: [3, 7] },
      '사릉': { arrivals: [1, 5] },
      '금곡': { arrivals: [2, 6] },
      '평내호평': { arrivals: [3, 7] },
      '천마산': { arrivals: [1, 5] },
      '마석': { arrivals: [2, 6] },
      '대성리': { arrivals: [3, 7] },
      '청평': { arrivals: [1, 5] },
      '상천': { arrivals: [2, 6] },
      '가평': { arrivals: [3, 7] },
      '굴봉산': { arrivals: [1, 5] },
      '백양리': { arrivals: [2, 6] },
      '강촌': { arrivals: [3, 7] },
      '김유정': { arrivals: [1, 5] },
      '남춘천': { arrivals: [2, 6] },
      '춘천': { arrivals: [3, 7] }
    };

    // 경강선 역 데이터
    const gyeonggangStationData = {
      '판교': { arrivals: [1, 5] },
      '성남': { arrivals: [2, 6] },
      '이매': { arrivals: [3, 7] },
      '삼동': { arrivals: [1, 5] },
      '경기광주': { arrivals: [2, 6] },
      '초월': { arrivals: [3, 7] },
      '곤지암': { arrivals: [1, 5] },
      '신둔도예촌': { arrivals: [2, 6] },
      '이천': { arrivals: [3, 7] },
      '부발': { arrivals: [1, 5] },
      '세종대왕릉': { arrivals: [2, 6] },
      '여주': { arrivals: [3, 7] }
    };

    // 인천1호선 역 데이터
    const incheon1StationData = {
      '검단': { arrivals: [1, 5] },
      '인천원당': { arrivals: [2, 6] },
      '계양천': { arrivals: [3, 7] },
      '계양': { arrivals: [1, 5] },
      '귤현': { arrivals: [2, 6] },
      '박촌': { arrivals: [3, 7] },
      '임학': { arrivals: [1, 5] },
      '계산': { arrivals: [2, 6] },
      '경인교대입구': { arrivals: [3, 7] },
      '작전': { arrivals: [1, 5] },
      '갈산': { arrivals: [2, 6] },
      '부평': { arrivals: [3, 7], transfers: ['1호선'] },
      '동수': { arrivals: [1, 5] },
      '부평삼거리': { arrivals: [2, 6] },
      '간석오거리': { arrivals: [3, 7] },
      '인천시청': { arrivals: [1, 5], transfers: ['GTX-B'] },
      '예술회관': { arrivals: [2, 6] },
      '인천터미널': { arrivals: [3, 7] },
      '문학경기장': { arrivals: [1, 5] },
      '선학': { arrivals: [2, 6] },
      '신연수': { arrivals: [3, 7] },
      '원인재': { arrivals: [1, 5] },
      '동춘': { arrivals: [2, 6] },
      '동막': { arrivals: [3, 7] },
      '캠퍼스타운': { arrivals: [1, 5] },
      '테크노파크': { arrivals: [2, 6] },
      '지식정보단지': { arrivals: [3, 7] },
      '인천대입구': { arrivals: [1, 5] },
      '센트럴파크': { arrivals: [2, 6] },
      '국제업무지구': { arrivals: [3, 7] },
      '송도': { arrivals: [1, 5] },
      '달빛축제공원': { arrivals: [2, 6] }
    };

    // 인천2호선 역 데이터
    const incheon2StationData = {
      '검단오류': { arrivals: [1, 5] },
      '왕길': { arrivals: [2, 6] },
      '검단사거리': { arrivals: [3, 7] },
      '마전': { arrivals: [1, 5] },
      '완정': { arrivals: [2, 6] },
      '독정': { arrivals: [3, 7] },
      '검암': { arrivals: [1, 5] },
      '검바위': { arrivals: [2, 6] },
      '아시아드경기장': { arrivals: [3, 7] },
      '서구청': { arrivals: [1, 5] },
      '가정': { arrivals: [2, 6] },
      '가정중앙시장': { arrivals: [3, 7] },
      '석남': { arrivals: [1, 5] },
      '서부여성회관': { arrivals: [2, 6] },
      '인천가좌': { arrivals: [3, 7] },
      '가재울': { arrivals: [1, 5] },
      '주안국가산단': { arrivals: [2, 6] },
      '주안': { arrivals: [3, 7], transfers: ['1호선'] },
      '시민공원': { arrivals: [1, 5] },
      '석바위시장': { arrivals: [2, 6] },
      '인천시청': { arrivals: [3, 7], transfers: ['GTX-B'] },
      '석천사거리': { arrivals: [1, 5] },
      '모래내시장': { arrivals: [2, 6] },
      '만수': { arrivals: [3, 7] },
      '남동구청': { arrivals: [1, 5] },
      '인천대공원': { arrivals: [2, 6] },
      '운연': { arrivals: [3, 7] }
    };

    // 서해선 역 데이터
    const seohaeStationData = {
      '일산': { arrivals: [1, 5] },
      '풍산': { arrivals: [2, 6] },
      '백마': { arrivals: [3, 7] },
      '곡산': { arrivals: [1, 5] },
      '대곡': { arrivals: [2, 6], transfers: ['3호선', 'GTX-A'] },
      '능곡': { arrivals: [3, 7] },
      '김포공항': { arrivals: [1, 5], transfers: ['공항철도'] },
      '원종': { arrivals: [2, 6] },
      '부천종합운동장': { arrivals: [3, 7] },
      '소사': { arrivals: [1, 5] },
      '소새울': { arrivals: [2, 6] },
      '시흥대야': { arrivals: [3, 7] },
      '신천': { arrivals: [1, 5] },
      '신현': { arrivals: [2, 6] },
      '시흥시청': { arrivals: [3, 7] },
      '시흥능곡': { arrivals: [1, 5] },
      '달미': { arrivals: [2, 6] },
      '선부': { arrivals: [3, 7] },
      '초지': { arrivals: [1, 5] },
      '시우': { arrivals: [2, 6] },
      '원시': { arrivals: [3, 7] }
    };

    // 김포골드라인 역 데이터
    const gimpoStationData = {
      '김포공항': { arrivals: [1, 5] },
      '고촌': { arrivals: [2, 6] },
      '풍무': { arrivals: [3, 7] },
      '사우': { arrivals: [1, 5] },
      '걸포북변': { arrivals: [2, 6] },
      '운양': { arrivals: [3, 7] },
      '장기': { arrivals: [1, 5] },
      '마산': { arrivals: [2, 6] },
      '구래': { arrivals: [3, 7] },
      '양촌': { arrivals: [1, 5] }
    };

    // 공항철도 역 데이터
    const airportStationData = {
      '인천공항2터미널': { arrivals: [1, 5] },
      '인천공항1터미널': { arrivals: [2, 6] },
      '공항화물청사': { arrivals: [3, 7] },
      '운서': { arrivals: [1, 5] },
      '영종': { arrivals: [2, 6] },
      '청라국제도시': { arrivals: [3, 7] },
      '검암': { arrivals: [1, 5] },
      '계양': { arrivals: [2, 6] },
      '김포공항': { arrivals: [3, 7] },
      '마곡나루': { arrivals: [1, 5] },
      '디지털미디어시티': { arrivals: [2, 6] },
      '홍대입구': { arrivals: [3, 7] },
      '공덕': { arrivals: [1, 5] },
      '서울역': { arrivals: [2, 6] }
    };

    let currentStationIndex = 0; // 방화역이 첫 번째
    let arrivalTimes = [3, 8]; // 초기 도착시간 (더 현실적인 값)
    let useRealAPI = true; // 실제 API 사용 여부

    // 지하철 운행 시간 체크 (5호선: 05:30 ~ 24:00)
    function isSubwayOperating() {
      const now = new Date();
      const hour = now.getHours();
      const minute = now.getMinutes();
      const currentTime = hour * 60 + minute;
      
      // 05:30 (330분) ~ 24:00 (1440분)
      return currentTime >= 330 && currentTime <= 1440;
    }

    // 운행 종료 시 표시할 메시지
    function displayServiceEnded() {
      document.getElementById('next-train-1').textContent = '운행 종료';
      document.getElementById('next-train-2').textContent = '운행 종료';
      
      // 스타일 적용
      document.querySelectorAll('.eta').forEach(element => {
        element.style.color = '#888';
        element.style.fontWeight = '400';
      });
    }

    // 개선된 API 호출 함수
    async function getRealtimeArrival(stationName) {
      try {
        // 역 이름 정리 (공백 제거, 특수문자 처리)
        const cleanStationName = stationName.trim().replace(/\s+/g, '');
        const originalUrl = `http://swopenapi.seoul.go.kr/api/subway/${API_CONFIG.API_KEY}/json/realtimeStationArrival/0/5/${encodeURIComponent(cleanStationName)}`;
        console.log('🔍 API 호출 시작:', originalUrl);
        console.log('📍 역 이름:', cleanStationName);
        
        // 여러 방법으로 시도
        const methods = [
          // 방법 1: 직접 호출 (가장 간단)
          async () => {
            console.log('🔄 직접 호출 시도');
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000);
            
            const response = await fetch(originalUrl, {
              method: 'GET',
              mode: 'cors',
              signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            return response;
          },
          
          // 방법 1.5: 직접 호출 (no-cors 모드)
          async () => {
            console.log('🔄 직접 호출 시도 (no-cors)');
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000);
            
            const response = await fetch(originalUrl, {
              method: 'GET',
              mode: 'no-cors',
              signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            // no-cors 모드에서는 응답을 읽을 수 없으므로 null 반환
            if (response.status === 0) {
              console.warn('⚠️ no-cors 모드 - 응답 확인 불가');
              return null;
            }
            
            return response;
          },
          
          // 방법 2: 다른 CORS 프록시 시도
          async () => {
            const proxyUrl = `https://thingproxy.freeboard.io/fetch/${originalUrl}`;
            console.log('🔄 ThingProxy 사용:', proxyUrl);
            
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 8000);
            
            const response = await fetch(proxyUrl, {
              method: 'GET',
              signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            return response;
          },
          
          // 방법 3: AllOrigins 프록시 시도
          async () => {
            const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(originalUrl)}`;
            console.log('🔄 AllOrigins 프록시 사용:', proxyUrl);
            
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 15000);
            
            try {
              const response = await fetch(proxyUrl, {
                method: 'GET',
                signal: controller.signal,
                headers: {
                  'Accept': 'application/json'
                }
              });
              
              clearTimeout(timeoutId);
              
              if (!response.ok) {
                throw new Error(`프록시 오류: ${response.status}`);
              }
              
              const data = await response.json();
              return {
                ok: true,
                status: 200,
                json: () => Promise.resolve(data)
              };
            } catch (error) {
              clearTimeout(timeoutId);
              throw error;
            }
          }
        ];
        
        for (let i = 0; i < methods.length; i++) {
          try {
            console.log(`🔄 방법 ${i + 1} 시도 중...`);
            const response = await methods[i]();
            
            console.log('📡 API 응답 상태:', response.status, response.statusText);
            
            if (!response.ok) {
              throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            console.log('📊 API 응답 데이터:', data);

            // API 오류 메시지 확인 (더 안전한 방식)
            if (data.errorMessage) {
              const errorMsg = typeof data.errorMessage === 'object' 
                ? JSON.stringify(data.errorMessage) 
                : data.errorMessage;
              
              // "정상 처리되었습니다" 메시지는 오류가 아님
              if (errorMsg.includes('정상 처리되었습니다') || errorMsg.includes('INFO-000')) {
                console.log("✅ API 정상 응답:", errorMsg);
              } else {
                console.error("❌ API 오류 메시지:", errorMsg);
                throw new Error(`API 오류: ${errorMsg}`);
              }
            }

            // API 상태 코드 확인 (데이터 없음 오류 제외)
            if (data.status && data.status !== 200 && data.status !== 500) {
              console.error("❌ API 상태 오류:", data.status, data.message);
              throw new Error(`API 상태 오류: ${data.status} - ${data.message}`);
            }

            // "해당하는 데이터가 없습니다" 오류 처리
            if (data.message && data.message.includes('해당하는 데이터가 없습니다')) {
              console.warn("⚠️ 해당 역의 실시간 데이터가 없습니다:", cleanStationName);
              return { error: 'no_data', message: '해당 역의 실시간 데이터가 없습니다' };
            }

            // "정상 처리되었습니다" 메시지 처리
            if (data.message && data.message.includes('정상 처리되었습니다')) {
              console.log("✅ API 정상 응답:", data.message);
              // 정상 응답이지만 realtimeArrivalList가 없을 수 있음
            }

            // 응답 구조 확인
            if (!data.realtimeArrivalList) {
              console.warn("⚠️ realtimeArrivalList가 없습니다. 응답 구조:", Object.keys(data));
              continue;
            }

            const arrivals = data.realtimeArrivalList;
            if (!arrivals || arrivals.length === 0) {
              console.log("ℹ️ 도착 정보 없음");
              return null;
            }

            console.log("✅ 실시간 도착 정보 수신:", arrivals.length, "개 열차");
            return arrivals;
            
          } catch (error) {
            console.warn(`❌ 방법 ${i + 1} 실패:`, error.message);
            if (i === methods.length - 1) {
              throw error;
            }
          }
        }
        
        throw new Error('모든 API 호출 방법이 실패했습니다');
        
      } catch (error) {
        if (error.name === 'AbortError') {
          console.error("⏰ API 호출 타임아웃");
          return { error: 'timeout', message: 'API 응답 시간 초과' };
        } else if (error.message.includes('Failed to fetch')) {
          console.error("🌐 네트워크 오류 - CORS 또는 연결 실패");
          return { error: 'network', message: '네트워크 연결 실패' };
        } else if (error.message.includes('HTTP')) {
          console.error("🔴 HTTP 오류:", error.message);
          return { error: 'http', message: `HTTP 오류: ${error.message}` };
        } else {
          console.error("❌ API 호출 실패:", error.message);
          return { error: 'unknown', message: `알 수 없는 오류: ${error.message}` };
        }
      }
    }

    // 실제 API에서 데이터 가져오기
    async function fetchRealTimeData() {
      // 운행 시간이 아니면 API 호출하지 않음
      if (!isSubwayOperating()) {
        displayServiceEnded();
        return null;
      }

      try {
        // 현재 선택된 역과 호선 정보 가져오기
        const currentStationElement = document.getElementById('current-station');
        const currentLineNumberElement = document.querySelector('.line-number');
        
        if (!currentStationElement || !currentLineNumberElement) {
          console.error('필수 요소를 찾을 수 없습니다:', {
            currentStation: currentStationElement,
            currentLineNumber: currentLineNumberElement
          });
          return null;
        }
        
        const currentStation = currentStationElement.textContent;
        const currentLineNumber = currentLineNumberElement.textContent;
        
        // 새로운 간단한 API 호출 사용
        const result = await getRealtimeArrival(currentStation);
        
        // 오류 상태 확인
        if (result && result.error) {
          console.log(`API 오류 발생: ${result.error} - ${result.message}`);
          
          // 특별한 오류 처리
          if (result.error === 'no_data') {
            console.warn('⚠️ 해당 역의 실시간 데이터가 없습니다');
            return { error: 'no_data', message: '해당 역의 실시간 데이터가 없습니다' };
          } else if (result.error === 'timeout') {
            console.error('⏰ API 응답 시간 초과');
            return { error: 'timeout', message: 'API 응답 시간 초과' };
          } else if (result.error === 'network') {
            console.error('🌐 네트워크 연결 실패');
            return { error: 'network', message: '네트워크 연결 실패' };
          } else {
            return { error: result.error, message: result.message };
          }
        }
        
        // 정상 데이터 처리
        if (result && result.length > 0) {
          console.log(`실시간 도착 정보 수신: ${result.length}개 열차`);
          
          // displayRealTimeData 함수를 사용하여 방향별로 표시
          displayRealTimeData(result);
          
          return result;
        } else {
          console.log('도착 정보 없음, 시뮬레이션으로 전환');
          return null;
        }
      } catch (error) {
        console.error('API 호출 중 오류 발생:', error);
        return null;
      }
    }

    // API 데이터를 화면에 표시
    function displayRealTimeData(apiData) {
      if (!apiData || apiData.length === 0) {
        console.log('⚠️ API 데이터가 없습니다. 시뮬레이션 모드로 전환합니다.');
        // 시뮬레이션 모드에서는 더 현실적인 도착시간 사용
        arrivalTimes = [Math.floor(Math.random() * 5) + 2, Math.floor(Math.random() * 8) + 6];
        updateArrivalTimes();
        return;
      }

      // API 데이터를 전역 변수에 저장 (방향 변경 시 재사용)
      window.lastAPIData = apiData;
      
      // API 데이터 구조 상세 로그
      console.log('🔍 API 데이터 상세 분석:');
      console.log('📊 전체 데이터 개수:', apiData.length);
      apiData.forEach((train, index) => {
        const minutes = train.barvlDt ? Math.round(train.barvlDt / 60) : 'N/A';
        console.log(`🚂 열차 ${index + 1}:`, {
          updnLine: train.updnLine,
          bstatnNm: train.bstatnNm,
          arvlMsg2: train.arvlMsg2,
          arvlMsg3: train.arvlMsg3,
          barvlDt: train.barvlDt,
          calculatedMinutes: minutes,
          // 추가 정보
          subwayId: train.subwayId,
          subwayNm: train.subwayNm,
          statnId: train.statnId,
          statnNm: train.statnNm,
          ordkey: train.ordkey,
          subwayList: train.subwayList,
          statnList: train.statnList,
          btrainSttus: train.btrainSttus,
          btrainNo: train.btrainNo,
          bstatnId: train.bstatnId,
          recptnDt: train.recptnDt,
          arvlMsg2: train.arvlMsg2,
          arvlMsg3: train.arvlMsg3,
          arvlCd: train.arvlCd
        });
      });

      // 현재 선택된 방향 확인
      const selectedDirection = document.querySelector('input[name="dir"]:checked');
      const isUpDirection = selectedDirection && selectedDirection.value === 'up';

      // 방향에 따라 열차 필터링
      const filteredTrains = apiData.filter(train => {
        const isUpTrain = train.updnLine === '상행' || train.updnLine === '0';
        const isDownTrain = train.updnLine === '하행' || train.updnLine === '1';
        
        console.log(`🔍 열차 필터링: ${train.bstatnNm}행 (${train.updnLine}) - 상행:${isUpTrain}, 하행:${isDownTrain}, 선택방향:${isUpDirection ? '상행' : '하행'}`);
        
        if (isUpDirection) {
          return isUpTrain;
        } else {
          return isDownTrain;
        }
      }).slice(0, 2);

      console.log(`🚂 ${isUpDirection ? '상행' : '하행'} 방향 열차 ${filteredTrains.length}개 발견`);

      // 첫 번째 열차 정보 표시
      if (filteredTrains.length > 0) {
        const firstTrain = filteredTrains[0];
        const firstElement = document.getElementById('next-train-1');
        const firstDestElement = document.getElementById('current-train-dest');
        
        if (firstElement) {
          // API에서 도착시간 계산 (barvlDt는 초 단위)
          let arrivalTime;
          if (firstTrain.barvlDt) {
            const minutes = Math.round(firstTrain.barvlDt / 60);
            arrivalTime = minutes <= 1 ? "곧 도착" : `${minutes}분 후 도착`;
            console.log(`🚂 첫 번째 열차 도착시간: ${firstTrain.barvlDt}초 → ${minutes}분 → ${arrivalTime}`);
          } else {
            arrivalTime = firstTrain.arvlMsg2 || firstTrain.arvlMsg3 || '정보없음';
            console.log(`🚂 첫 번째 열차 도착시간 (메시지): ${arrivalTime}`);
          }
          
          firstElement.textContent = arrivalTime;
          
          // 특별한 상황 표시
          if (arrivalTime.includes('진입') || arrivalTime.includes('도착') || arrivalTime.includes('곧 도착')) {
            firstElement.style.color = "#ff6b6b";
            firstElement.style.fontWeight = "800";
          } else if (arrivalTime.includes('지연')) {
            firstElement.style.color = "#ffa500";
            firstElement.style.fontWeight = "700";
          } else {
            firstElement.style.color = "var(--sign-blue)";
            firstElement.style.fontWeight = "700";
          }
        }
        
        // 첫 번째 열차 행선지 표시
        if (firstDestElement && firstTrain.bstatnNm) {
          firstDestElement.textContent = `이번열차 ${firstTrain.bstatnNm}행`;
          console.log(`🎯 첫 번째 열차 행선지: ${firstTrain.bstatnNm} (방향: ${firstTrain.updnLine})`);
        }
      }

      // 두 번째 열차 정보 표시
      if (filteredTrains.length > 1) {
        const secondTrain = filteredTrains[1];
        const secondElement = document.getElementById('next-train-2');
        const secondDestElement = document.getElementById('next-train-dest');
        
        if (secondElement) {
          // API에서 도착시간 계산 (barvlDt는 초 단위)
          let arrivalTime;
          if (secondTrain.barvlDt) {
            const minutes = Math.round(secondTrain.barvlDt / 60);
            arrivalTime = minutes <= 1 ? "곧 도착" : `${minutes}분 후 도착`;
            console.log(`🚂 두 번째 열차 도착시간: ${secondTrain.barvlDt}초 → ${minutes}분 → ${arrivalTime}`);
          } else {
            arrivalTime = secondTrain.arvlMsg2 || secondTrain.arvlMsg3 || '정보없음';
            console.log(`🚂 두 번째 열차 도착시간 (메시지): ${arrivalTime}`);
          }
          
          secondElement.textContent = arrivalTime;
          
          // 특별한 상황 표시
          if (arrivalTime.includes('진입') || arrivalTime.includes('도착') || arrivalTime.includes('곧 도착')) {
            secondElement.style.color = "#ff6b6b";
            secondElement.style.fontWeight = "800";
          } else if (arrivalTime.includes('지연')) {
            secondElement.style.color = "#ffa500";
            secondElement.style.fontWeight = "700";
          } else {
            secondElement.style.color = "var(--sign-cyan)";
            secondElement.style.fontWeight = "700";
          }
        }
        
        // 두 번째 열차 행선지 표시
        if (secondDestElement && secondTrain.bstatnNm) {
          secondDestElement.textContent = `다음열차 ${secondTrain.bstatnNm}행`;
          console.log(`🎯 두 번째 열차 행선지: ${secondTrain.bstatnNm} (방향: ${secondTrain.updnLine})`);
        }
      } else {
        // 두 번째 열차가 없으면 빈 값으로 설정
        const secondElement = document.getElementById('next-train-2');
        const secondDestElement = document.getElementById('next-train-dest');
        if (secondElement) secondElement.textContent = '';
        if (secondDestElement) secondDestElement.textContent = '';
      }
    }

    // 시뮬레이션 모드 업데이트
    function updateArrivalTimes() {
      // 운행 시간이 아니면 운행 종료 메시지 표시
      if (!isSubwayOperating()) {
        displayServiceEnded();
        return;
      }

      // 도착시간을 1분씩 감소
      arrivalTimes = arrivalTimes.map(time => {
        if (time <= 1) {
          // 도착한 열차는 새로운 시간으로 교체 (3-15분 사이, 더 현실적)
          return Math.floor(Math.random() * 13) + 3;
        }
        return time - 1;
      });

      // 논리적 순서 보장: 1번째 < 2번째
      arrivalTimes.sort((a, b) => a - b);
      // === 동시 도착 방지: 같은 방향 한 역에 2대 동시 도착 금지 ===
      (function enforceHeadway(){
        const MIN_HEADWAY = 1; // 최소 1분 간격
        if (arrivalTimes.length >= 2) {
          // 둘 다 1분 이하면 한 대만 즉시, 나머지는 뒤로 민다
          if (arrivalTimes[0] <= 1 && arrivalTimes[1] <= 1) {
            arrivalTimes[1] = arrivalTimes[0] + MIN_HEADWAY + 1; // 최소 2분
          }
          // 값이 같다면 두 번째를 뒤로 민다
          if (arrivalTimes[0] === arrivalTimes[1]) {
            arrivalTimes[1] = arrivalTimes[0] + MIN_HEADWAY;
          }
          // 간격이 너무 좁으면 보정
          if (arrivalTimes[1] - arrivalTimes[0] < MIN_HEADWAY) {
            arrivalTimes[1] = arrivalTimes[0] + MIN_HEADWAY;
          }
        }
      })();


      // DOM 업데이트
      document.getElementById('next-train-1').textContent = `${arrivalTimes[0]}분 후 도착`;
      document.getElementById('next-train-2').textContent = `${arrivalTimes[1]}분 후 도착`;

      // 특별한 상황 표시
      if (arrivalTimes[0] <= 1) {
        document.getElementById('next-train-1').textContent = "곧 도착";
        document.getElementById('next-train-1').style.color = "#ff6b6b";
        document.getElementById('next-train-1').style.fontWeight = "800";
      } else {
        document.getElementById('next-train-1').style.color = "var(--sign-blue)";
        document.getElementById('next-train-1').style.fontWeight = "700";
      }
    }

    // API 상태 표시 함수
    function updateAPIStatus(status = 'checking', message = '') {
      const statusElement = document.getElementById('api-status');
      if (!statusElement) return;
      
      const statusConfig = {
        'checking': { icon: '🟡', text: 'API 확인 중...', color: '#ffa500' },
        'connected': { icon: '🟢', text: '실시간 데이터 연결됨', color: '#28a745' },
        'failed': { icon: '🔴', text: 'API 연결 실패', color: '#dc3545' },
        'simulation': { icon: '🔴', text: '시뮬레이션 모드', color: '#6c757d' },
        'timeout': { icon: '⏰', text: 'API 응답 시간 초과', color: '#fd7e14' },
        'network': { icon: '🌐', text: '네트워크 오류', color: '#e83e8c' },
        'cors': { icon: '🚫', text: 'CORS 오류', color: '#6f42c1' }
      };
      
      const config = statusConfig[status] || statusConfig['checking'];
      statusElement.innerHTML = `${config.icon} ${message || config.text}`;
      statusElement.style.color = config.color;
      statusElement.style.fontWeight = 'bold';
      
      // 상태에 따른 추가 정보 표시
      if (status === 'failed' || status === 'timeout' || status === 'network' || status === 'cors') {
        statusElement.title = '개발자 도구(F12)의 콘솔에서 자세한 오류 정보를 확인하세요.';
      } else if (message) {
        statusElement.title = message;
      }
    }

    // 통합 업데이트 함수
    async function updateDisplay() {
      console.log('=== 업데이트 시작 ===');
      console.log('useRealAPI:', useRealAPI);
      console.log('API_KEY:', API_CONFIG.API_KEY);
      console.log('API_KEY 길이:', API_CONFIG.API_KEY ? API_CONFIG.API_KEY.length : 'undefined');
      console.log('운행시간 체크:', isSubwayOperating());
      
      // API 상태 업데이트
      updateAPIStatus();
      
      if (useRealAPI && API_CONFIG.API_KEY && API_CONFIG.API_KEY !== 'YOUR_API_KEY_HERE') {
        console.log('API 모드로 시도 중...');
        updateAPIStatus('checking', '실시간 데이터를 가져오는 중...');
        const apiData = await fetchRealTimeData();
        
        // 오류 상태 확인
        if (apiData && apiData.error) {
          console.log('API 오류 발생:', apiData.error, apiData.message);
          
          // 특별한 오류 처리
          if (apiData.error === 'no_data') {
            updateAPIStatus('warning', '해당 역의 실시간 데이터가 없습니다');
          } else if (apiData.error === 'timeout') {
            updateAPIStatus('error', 'API 응답 시간 초과');
          } else if (apiData.error === 'network') {
            updateAPIStatus('error', '네트워크 연결 실패');
          } else {
            updateAPIStatus('error', apiData.message);
          }
          
          updateArrivalTimes();
        } else if (apiData && apiData.length > 0) {
          console.log('API 데이터 사용:', apiData);
          updateAPIStatus('connected', '실시간 데이터 연결됨');
          displayRealTimeData(apiData);
        } else {
          console.log('API 데이터 없음, 시뮬레이션으로 전환');
          updateAPIStatus('failed', 'API 응답 없음 - 시뮬레이션 데이터 사용');
          updateArrivalTimes();
        }
      } else {
        console.log('시뮬레이션 모드 사용 - API 키 문제:', {
          useRealAPI: useRealAPI,
          hasAPIKey: !!API_CONFIG.API_KEY,
          keyLength: API_CONFIG.API_KEY ? API_CONFIG.API_KEY.length : 0,
          isDefaultKey: API_CONFIG.API_KEY === 'YOUR_API_KEY_HERE'
        });
        updateAPIStatus('simulation', 'API 키 미설정 - 시뮬레이션 모드');
        updateArrivalTimes();
      }
    }

    // 역 변경 시뮬레이션 (30초마다)
    function changeStation() {
      currentStationIndex = (currentStationIndex + 1) % stations.length;
      const station = stations[currentStationIndex];
      
      document.querySelector('.current-station').textContent = station.name;
      arrivalTimes = [...station.arrivals];
      
      // 도착정보 업데이트
      updateArrivalTimes();
    }

    // API 연결 진단 함수
    function diagnoseAPIConnection() {
      console.log('🔍 API 연결 진단 시작...');
      console.log('API 키:', API_CONFIG.API_KEY);
      console.log('API 키 길이:', API_CONFIG.API_KEY ? API_CONFIG.API_KEY.length : 'undefined');
      console.log('API URL:', API_CONFIG.API_URL);
      console.log('useRealAPI:', useRealAPI);
      console.log('현재 시간:', new Date().toLocaleString());
      console.log('지하철 운행 시간:', isSubwayOperating());
      
      // 네트워크 상태 확인
      if (navigator.onLine) {
        console.log('✅ 온라인 상태');
      } else {
        console.log('❌ 오프라인 상태');
      }
      
      // 브라우저 정보
      console.log('브라우저:', navigator.userAgent);
      console.log('언어:', navigator.language);
    }

    // API 테스트 버튼 이벤트
    document.addEventListener('DOMContentLoaded', function() {
      const apiTestBtn = document.getElementById('api-test-btn');
      if (apiTestBtn) {
        apiTestBtn.addEventListener('click', async function() {
          console.log('🧪 API 테스트 시작...');
          updateAPIStatus('checking', 'API 테스트 중...');
          
          // 진단 정보 출력
          diagnoseAPIConnection();
          
          // 서울역으로 테스트
          const testResult = await getRealtimeArrival('서울역');
          
          if (testResult && testResult.error) {
            console.log('❌ API 테스트 실패:', testResult.error, testResult.message);
            updateAPIStatus(testResult.error, `테스트 실패: ${testResult.message}`);
            
            let errorDetails = `API 테스트 실패:\n${testResult.message}\n\n`;
            errorDetails += `오류 유형: ${testResult.error}\n\n`;
            errorDetails += `해결 방법:\n`;
            
            switch (testResult.error) {
              case 'timeout':
                errorDetails += '• 네트워크 연결을 확인하세요\n• 방화벽 설정을 확인하세요\n• 잠시 후 다시 시도하세요';
                break;
              case 'network':
                errorDetails += '• 인터넷 연결을 확인하세요\n• CORS 정책 문제일 수 있습니다\n• 다른 브라우저로 시도해보세요';
                break;
              case 'http':
                errorDetails += '• API 서버 상태를 확인하세요\n• API 키가 올바른지 확인하세요\n• 잠시 후 다시 시도하세요';
                break;
              default:
                errorDetails += '• 개발자 도구(F12)의 콘솔에서 자세한 정보를 확인하세요';
            }
            
            alert(errorDetails);
          } else if (testResult && testResult.length > 0) {
            console.log('✅ API 테스트 성공:', testResult.length, '개 열차 데이터');
            updateAPIStatus('connected', 'API 테스트 성공');
            alert(`API 테스트 성공!\n서울역에서 ${testResult.length}개 열차의 실시간 정보를 받아왔습니다.`);
          } else {
            console.log('⚠️ API 테스트: 데이터 없음');
            updateAPIStatus('failed', '테스트: 도착 정보 없음');
            alert('API 테스트: 서울역의 도착 정보가 없습니다.\n\n이는 다음 중 하나일 수 있습니다:\n• 현재 운행 시간이 아닙니다\n• 해당 역에 열차가 없습니다\n• API 서버에 일시적인 문제가 있습니다');
          }
        });
      }
    });

    // 초기 실행은 DOMContentLoaded 안에서 실행
    
    // 30초마다 역 변경 (선택사항)
    // setInterval(changeStation, 30000);

    // 지연/운행중단 시뮬레이션 (가끔 발생)
    function simulateDelay() {
      if (Math.random() < 0.1) { // 10% 확률
        const delayMinutes = Math.floor(Math.random() * 5) + 2; // 2-6분 지연
        arrivalTimes[0] += delayMinutes;
        document.getElementById('next-train-1').textContent = `${arrivalTimes[0]}분 후 도착 (지연)`;
        document.getElementById('next-train-1').style.color = "#ffa500";
      }
    }

    // 5분마다 지연 시뮬레이션 체크
    setInterval(simulateDelay, 300000);

    // 열차 위치 및 애니메이션 관리
    const stationElements = document.querySelectorAll('.station');
    let currentTrainPosition = 48; // 하남검단산역이 마지막 (인덱스 48)
    let isTrainMoving = false;

    // 열차 위치 업데이트 함수
    function updateTrainPosition() {
      const nextArrival = arrivalTimes[0]; // 다음 도착시간
      
      // 현재 표시된 호선의 역 개수 확인
      const currentStations = document.querySelector('.stations[style*="flex"] .station');
      const totalStations = document.querySelectorAll('.stations[style*="flex"] .station').length;
      
      // trainIcon 요소 확인
      let trainIcon = document.getElementById('train-icon');
      if (!trainIcon) {
        // train-icon 요소 생성 (조용히)
        // train-icon 요소가 없으면 생성
        trainIcon = document.createElement('div');
        trainIcon.id = 'train-icon';
        trainIcon.className = 'train-img';
        trainIcon.style.position = 'absolute';
        trainIcon.style.width = '20px';
        trainIcon.style.height = '20px';
        trainIcon.style.backgroundColor = '#ff6b6b';
        trainIcon.style.borderRadius = '50%';
        trainIcon.style.zIndex = '10';
        
        // 첫 번째 역에 추가
        const firstStation = document.querySelector('.stations[style*="flex"] .station');
        if (firstStation) {
          firstStation.appendChild(trainIcon);
        }
      }
      
      // 도착시간에 따른 열차 위치 계산 (현재 호선 기준)
      let targetPosition;
      if (nextArrival <= 1) {
        // 1분 이하면 마지막 역에 도착
        targetPosition = totalStations - 1;
        trainIcon.className = 'train-img at-station';
        isTrainMoving = false;
      } else if (nextArrival <= 3) {
        // 3분 이하면 마지막에서 두 번째 역 근처 (접근 중)
        targetPosition = Math.max(0, totalStations - 2);
        trainIcon.className = 'train-img approaching';
        isTrainMoving = true;
      } else if (nextArrival <= 6) {
        // 6분 이하면 중간 지점 근처
        targetPosition = Math.max(0, Math.floor(totalStations * 0.7));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      } else if (nextArrival <= 10) {
        // 10분 이하면 중간 지점 근처
        targetPosition = Math.max(0, Math.floor(totalStations * 0.6));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      } else if (nextArrival <= 15) {
        // 15분 이하면 중간 지점 근처
        targetPosition = Math.max(0, Math.floor(totalStations * 0.5));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      } else if (nextArrival <= 20) {
        // 20분 이하면 중간 지점 근처
        targetPosition = Math.max(0, Math.floor(totalStations * 0.4));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      } else if (nextArrival <= 25) {
        // 25분 이하면 중간 지점 근처
        targetPosition = Math.max(0, Math.floor(totalStations * 0.3));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      } else if (nextArrival <= 30) {
        // 30분 이하면 중간 지점 근처
        targetPosition = Math.max(0, Math.floor(totalStations * 0.2));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      } else {
        // 30분 초과면 더 먼 역들
        targetPosition = Math.max(0, Math.floor(totalStations * 0.1));
        trainIcon.className = 'train-img moving';
        isTrainMoving = true;
      }

      // 열차 위치 이동
      if (targetPosition !== currentTrainPosition) {
        moveTrainToStation(targetPosition);
        currentTrainPosition = targetPosition;
      }
    }

    // 열차를 특정 역으로 이동시키는 함수
    function moveTrainToStation(stationIndex) {
      // 기존 열차 아이콘 제거
      const existingTrain = document.getElementById('train-icon');
      if (existingTrain) {
        existingTrain.remove();
      }

      // 새로운 위치에 열차 아이콘 추가
      const targetStation = stationElements[stationIndex];
      const newTrainIcon = document.createElement('img');
      newTrainIcon.id = 'train-icon';
      newTrainIcon.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCA0OCAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQ4IiBoZWlnaHQ9IjMyIiByeD0iNiIgZmlsbD0idXJsKCN0cmFpbkdyYWQpIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iMiIvPgo8cmVjdCB4PSI0IiB5PSIxMCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjE0IiByeD0iMyIgZmlsbD0iIzMzMzMzMyIvPgo8cmVjdCB4PSI2IiB5PSIxMiIgd2lkdGg9IjM2IiBoZWlnaHQ9IjEwIiByeD0iMiIgZmlsbD0iIzQ0NDQ0NCIvPgo8cmVjdCB4PSI4IiB5PSIxNCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjYiIHJ4PSIxIiBmaWxsPSIjNTU1NTU1Ii8+CjxyZWN0IHg9IjEwIiB5PSIxNiIgd2lkdGg9IjI4IiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjNjY2NjY2Ii8+CjxyZWN0IHg9IjEyIiB5PSIxOCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjNzc3Nzc3Ii8+CjxyZWN0IHg9IjE0IiB5PSIyMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjODg4ODg4Ii8+CjxyZWN0IHg9IjE2IiB5PSIyMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjOTk5OTk5Ii8+CjxyZWN0IHg9IjE4IiB5PSIyNCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjYWFhYWFhIi8+CjxyZWN0IHg9IjIwIiB5PSIyNiIgd2lkdGg9IjgiIGhlaWdodD0iMiIgcng9IjEiIGZpbGw9IiNiYmJiYmIiLz4KPGNpcmNsZSBjeD0iMTIiIGN5PSI4IiByPSIzIiBmaWxsPSIjMDBjMGZmIi8+CjxjaXJjbGUgY3g9IjIwIiBjeT0iOCIgcj0iMyIgZmlsbD0iIzAwYzBmZiIvPgo8Y2lyY2xlIGN4PSIyOCIgY3k9IjgiIHI9IjMiIGZpbGw9IiMwMGMwZmYiLz4KPGNpcmNsZSBjeD0iMzYiIGN5PSI4IiByPSIzIiBmaWxsPSIjMDBjMGZmIi8+CjxyZWN0IHg9IjEwIiB5PSI2IiB3aWR0aD0iMjgiIGhlaWdodD0iNCIgcng9IjIiIGZpbGw9IiMzMzMzMzMiLz4KPHJlY3QgeD0iMTIiIHk9IjgiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyIiByeD0iMSIgZmlsbD0iIzQ0NDQ0NCIvPgo8cmVjdCB4PSIxNCIgeT0iMTAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyIiByeD0iMSIgZmlsbD0iIzU1NTU1NSIvPgo8cmVjdCB4PSIxNiIgeT0iMTIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIyIiByeD0iMSIgZmlsbD0iIzY2NjY2NiIvPgo8cmVjdCB4PSIxOCIgeT0iMTQiIHdpZHRoPSIxMiIgaGVpZ2h0PSIyIiByeD0iMSIgZmlsbD0iIzc3Nzc3NyIvPgo8cmVjdCB4PSIyMCIgeT0iMTYiIHdpZHRoPSI4IiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjODg4ODg4Ii8+CjxyZWN0IHg9IjIyIiB5PSIxOCIgd2lkdGg9IjQiIGhlaWdodD0iMiIgcng9IjEiIGZpbGw9IiM5OTk5OTkiLz4KPHJlY3QgeD0iMjQiIHk9IjIwIiB3aWR0aD0iMiIgaGVpZ2h0PSIyIiByeD0iMSIgZmlsbD0iI2FhYWFhYSIvPgo8cmVjdCB4PSIyNiIgeT0iMjIiIHdpZHRoPSIyIiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjYmJiYmJiIi8+CjxyZWN0IHg9IjI4IiB5PSIyNCIgd2lkdGg9IjIiIGhlaWdodD0iMiIgcng9IjEiIGZpbGw9IiNjY2NjY2MiLz4KPHJlY3QgeD0iMzAiIHk9IjI2IiB3aWR0aD0iMiIgaGVpZ2h0PSIyIiByeD0iMSIgZmlsbD0iI2RkZGRkZCIvPgo8cmVjdCB4PSIzMiIgeT0iMjgiIHdpZHRoPSIyIiBoZWlnaHQ9IjIiIHJ4PSIxIiBmaWxsPSIjZWVlZWVlIi8+CjxyZWN0IHg9IjM0IiB5PSIzMCIgd2lkdGg9IjIiIGhlaWdodD0iMiIgcng9IjEiIGZpbGw9IiNmNWY1ZjUiLz4KPGRlZnM+CjxsaW5lYXJHcmFkaWVudCBpZD0idHJhaW5HcmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6I2Y1ZjVmNTtzdG9wLW9wYWNpdHk6MSIgLz4KPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZTBlMGUwO3N0b3Atb3BhY2l0eToxIiAvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPg==';
      newTrainIcon.alt = '지하철 열차';
      newTrainIcon.className = 'train-img';
      targetStation.insertBefore(newTrainIcon, targetStation.querySelector('span'));
    }

    // 열차 애니메이션 업데이트를 기존 업데이트 함수에 통합
    const originalUpdateDisplay = updateDisplay;
    updateDisplay = async function() {
      await originalUpdateDisplay();
      updateTrainPosition();
    };

    // 초기 열차 위치 설정
    updateTrainPosition();

    // 역 클릭 이벤트 처리
    function handleStationClick(event) {
      const stationElement = event.currentTarget;
      const stationName = stationElement.getAttribute('data-station');
      
      if (allStationData[stationName]) {
        // 현재 역 정보 업데이트
        document.querySelector('.current-station').textContent = stationName + '역';
        
        // 운행 시간 체크
        if (!isSubwayOperating()) {
          // 운행 종료 시 메시지 표시
          displayServiceEnded();
        } else {
          // 도착 정보 업데이트
          const stationData = allStationData[stationName];
          arrivalTimes = [...stationData.arrivals];
          
          // 논리적 순서 보장: 1번째 < 2번째
          arrivalTimes.sort((a, b) => a - b);
      // === 동시 도착 방지: 같은 방향 한 역에 2대 동시 도착 금지 ===
      (function enforceHeadway(){
        const MIN_HEADWAY = 1; // 최소 1분 간격
        if (arrivalTimes.length >= 2) {
          // 둘 다 1분 이하면 한 대만 즉시, 나머지는 뒤로 민다
          if (arrivalTimes[0] <= 1 && arrivalTimes[1] <= 1) {
            arrivalTimes[1] = arrivalTimes[0] + MIN_HEADWAY + 1; // 최소 2분
          }
          // 값이 같다면 두 번째를 뒤로 민다
          if (arrivalTimes[0] === arrivalTimes[1]) {
            arrivalTimes[1] = arrivalTimes[0] + MIN_HEADWAY;
          }
          // 간격이 너무 좁으면 보정
          if (arrivalTimes[1] - arrivalTimes[0] < MIN_HEADWAY) {
            arrivalTimes[1] = arrivalTimes[0] + MIN_HEADWAY;
          }
        }
      })();

          
          // DOM 업데이트
          document.getElementById('next-train-1').textContent = `${arrivalTimes[0]}분 후 도착`;
          document.getElementById('next-train-2').textContent = `${arrivalTimes[1]}분 후 도착`;
          
          // 스타일 초기화
          document.querySelectorAll('.eta').forEach(element => {
            element.style.color = '';
            element.style.fontWeight = '';
          });
        }
        
        // 시각적 피드백
        stationElement.style.backgroundColor = '#00c0ff';
        stationElement.style.color = 'white';
        stationElement.style.transform = 'scale(1.1)';
        stationElement.style.transition = 'all 0.3s ease';
        
        // 다른 역들의 스타일 초기화
        document.querySelectorAll('.station').forEach(station => {
          if (station !== stationElement) {
            station.style.backgroundColor = '';
            station.style.color = '';
            station.style.transform = '';
          }
        });
        
        // 열차 위치 업데이트
        updateTrainPosition();
        
        console.log(`${stationName}역 클릭됨 - 운행시간: ${isSubwayOperating() ? '운행중' : '운행종료'}`);
      }
    }

    // 공통 함수: 노선 전환
    function switchLine(lineNumber, stationData, stationClass) {
      console.log(`노선 전환 시작: ${lineNumber}호선, 클래스: ${stationClass}`);
      
      // 모든 노선도 숨기기
      document.querySelectorAll('.stations').forEach(stations => {
        stations.style.display = 'none';
        console.log(`숨김: ${stations.className}`);
      });
      
      // 선택된 노선도 표시
      const targetStations = document.querySelector(`.${stationClass}`);
      console.log(`대상 노선도 찾기: .${stationClass}`, targetStations);
      
      if (targetStations) {
        targetStations.style.display = 'flex';
        console.log(`${stationClass} 노선도 표시됨`);
      } else {
        console.error(`${stationClass} 노선도를 찾을 수 없습니다!`);
      }
      
      // 노선 정보 업데이트
      console.log('호선 정보 업데이트 시작:', lineNumber);
      const lineNumberElement = document.querySelector('.line-number');
      const lineNameElement = document.querySelector('.line-name');
      
      if (lineNumberElement) {
        lineNumberElement.textContent = lineNumber;
        console.log('호선 번호 업데이트:', lineNumber);
      } else {
        console.error('호선 번호 요소를 찾을 수 없습니다!');
      }
      
      if (lineNameElement) {
        lineNameElement.textContent = `${lineNumber}호선`;
        console.log('호선 이름 업데이트:', `${lineNumber}호선`);
      } else {
        console.error('호선 이름 요소를 찾을 수 없습니다!');
      }
      
      // 호선 색상 업데이트
      updateLineColors(lineNumber);
      
      // 활성 노선 업데이트
      document.querySelectorAll('.line-item').forEach(item => item.classList.remove('active'));
      const activeLineItem = document.querySelector(`.line-${lineNumber}`);
      if (activeLineItem) {
        activeLineItem.classList.add('active');
      } else {
        console.warn(`호선 ${lineNumber}에 해당하는 .line-item 요소를 찾을 수 없습니다.`);
      }
      
      // 현재 역을 첫 번째 역으로 설정
      const firstStation = document.querySelector(`.${stationClass} .station`);
      console.log('첫 번째 역 찾기:', firstStation);
      if (firstStation) {
        const stationName = firstStation.dataset.station;
        console.log('설정할 역 이름:', stationName);
        document.getElementById('current-station').textContent = stationName;
        
        // 해당 호선 데이터로 도착시간 업데이트
        if (stationData[stationName]) {
          const arrivals = stationData[stationName].arrivals;
          arrivals.sort((a, b) => a - b);
          
          // 전역 arrivalTimes 변수 업데이트
          arrivalTimes = [...arrivals];
          
          // DOM 업데이트
          document.getElementById('next-train-1').textContent = `${arrivals[0]}분`;
          document.getElementById('next-train-2').textContent = `${arrivals[1]}분`;
          
          console.log('도착시간 업데이트:', arrivals);
        }
      }
      
      // 노선 전환 시 해당 노선의 역들에 이벤트 리스너 추가
      document.querySelectorAll(`.${stationClass} .station`).forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.dataset.station;
          console.log(`🎯 ${stationName}역 클릭됨 (노선 전환 후)`);
          document.getElementById('current-station').textContent = stationName;
          
          if (stationData[stationName]) {
            const arrivals = stationData[stationName].arrivals;
            arrivals.sort((a, b) => a - b);
            document.getElementById('next-train-1').textContent = `${arrivals[0]}분 후 도착`;
            document.getElementById('next-train-2').textContent = `${arrivals[1]}분 후 도착`;
          }
          
          // 클릭된 역 하이라이트
          document.querySelectorAll(`.${stationClass} .station`).forEach(s => s.classList.remove('clicked'));
          this.classList.add('clicked');
        });
      });
    }

    // 호선 색상 및 방향 업데이트 함수
    function updateLineColors(lineNumber) {
      console.log('updateLineColors 호출됨, 호선:', lineNumber);
      
          const lineColors = {
            1: '#0052A4',  // 1호선 파란색
            2: '#00A84D',  // 2호선 초록색
            '2성수': '#00A84D',  // 2호선 성수지선 초록색
            '2신정': '#00A84D',  // 2호선 신정지선 초록색
            3: '#EF7C1C',  // 3호선 주황색
            4: '#00A5DE',  // 4호선 하늘색
            5: '#A45BB9',  // 5호선 보라색
            6: '#CD7C2F',  // 6호선 갈색
            7: '#747F00',  // 7호선 올리브색
            8: '#E6186C',  // 8호선 분홍색
            9: '#BDB092',  // 9호선 베이지색
            '신분당': '#D4003B',  // 신분당선 빨간색
            '경의중앙': '#73C7A6',  // 경의중앙선 하늘색
            'GTX-A': '#8B5CF6',  // GTX-A 보라색
            '우이신설': '#B7CE63',  // 우이신설선 연한 초록색
            '신림': '#6789CA',  // 신림선 파란색
            '의정부': '#FD8100',  // 의정부경전철 주황색
            '용인에버': '#57C4E5',  // 용인에버라인 하늘색
            '분당': '#F5A200',  // 분당선 주황색
            '경춘': '#00A84D',  // 경춘선 초록색
            '경강': '#0052A4',  // 경강선 파란색
            '인천1': '#7CA8D5',  // 인천1호선 연한 파란색
            '인천2': '#F5A200',  // 인천2호선 노란색
            '서해': '#81C147',   // 서해선 연한 초록색
            '공항철도': '#0090D2',  // 공항철도 파란색
            '김포골드': '#A17800'   // 김포골드라인 골드색
          };
      
          const lineDestinations = {
            1: '하행',  // 1호선 - 하행
            2: '하행',  // 2호선 - 하행 (순환선)
            '2성수': '하행',  // 2호선 성수지선 - 하행
            '2신정': '하행',  // 2호선 신정지선 - 하행
            3: '하행',  // 3호선 - 하행
            4: '하행',  // 4호선 - 하행
            5: '하행',  // 5호선 - 하행
            6: '하행',  // 6호선 - 하행
            7: '하행',  // 7호선 - 하행
            8: '하행',  // 8호선 - 하행
            9: '하행',  // 9호선 - 하행
            '신분당': '하행',  // 신분당선 - 하행
            '경의중앙': '하행',  // 경의중앙선 - 하행
            'GTX-A': '하행',  // GTX-A - 하행
            '우이신설': '하행',  // 우이신설선 - 하행
            '신림': '하행',  // 신림선 - 하행
            '의정부': '하행',  // 의정부경전철 - 하행
            '용인에버': '하행',  // 용인에버라인 - 하행
            '분당': '하행',  // 분당선 - 하행
            '경춘': '하행',  // 경춘선 - 하행
            '경강': '하행',  // 경강선 - 하행
            '인천1': '하행',  // 인천1호선 - 하행
            '인천2': '하행',  // 인천2호선 - 하행
            '서해': '하행',   // 서해선 - 하행
            '공항철도': '하행',  // 공항철도 - 하행
            '김포골드': '하행'   // 김포골드라인 - 하행
          };
      
      const color = lineColors[lineNumber] || '#A45BB9'; // 기본값은 5호선 색상
      const destination = lineDestinations[lineNumber] || '하행'; // 기본값은 하행
      
      // 호선 번호 배경색 변경
      const lineNumberElement = document.querySelector('.line-number');
      console.log('호선 번호 요소 찾기:', lineNumberElement);
      if (lineNumberElement) {
        lineNumberElement.style.backgroundColor = color;
        console.log('호선 번호 배경색 설정:', color);
      } else {
        console.error('호선 번호 요소를 찾을 수 없습니다!');
      }
      
      // 호선 이름 색상 변경
      const lineNameElement = document.querySelector('.line-name');
      if (lineNameElement) {
        lineNameElement.style.color = color;
      }
      
      // 도착시간 색상 변경
      const etaElements = document.querySelectorAll('.eta');
      etaElements.forEach(element => {
        element.style.color = color;
      });
      
      // 열차 방향 업데이트
      const currentTrainDest = document.getElementById('current-train-dest');
      const nextTrainDest = document.getElementById('next-train-dest');
      if (currentTrainDest) {
        if (destination) {
        currentTrainDest.textContent = `이번열차 ${destination}`;
        } else {
          currentTrainDest.textContent = '이번열차';
        }
      }
      if (nextTrainDest) {
        if (destination) {
        nextTrainDest.textContent = `다음열차 ${destination}`;
        } else {
          nextTrainDest.textContent = '다음열차';
        }
      }
    }

    // 모든 호선 클릭 이벤트를 DOMContentLoaded 안에서 설정
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM 로드 완료, 이벤트 리스너 설정 시작');
      
      // 1호선 클릭 이벤트
      const line1Button = document.querySelector('.line-1');
      if (line1Button) {
        line1Button.addEventListener('click', function() {
          console.log('1호선 클릭됨!');
          switchLine(1, line1StationData, 'line1-stations');
          // 1호선의 첫 번째 역(연천역)으로 설정
          document.getElementById('current-station').textContent = '연천';
          arrivalTimes = line1StationData['연천'].arrivals;
          updateArrivalTimes();
        });
      }

      // 2호선 클릭 이벤트 (본선)
      const line2Button = document.querySelector('.line-2');
      if (line2Button) {
        line2Button.addEventListener('click', function() {
          console.log('2호선 본선 클릭됨!');
          switchLine(2, line2MainStationData, 'line2-main-stations');
        });
      } else {
        console.error('2호선 버튼을 찾을 수 없습니다!');
      }

      // 2호선 성수지선 클릭 이벤트
      const line2SeongsuButton = document.querySelector('.line-2-seongsu');
      if (line2SeongsuButton) {
        line2SeongsuButton.addEventListener('click', function() {
          console.log('2호선 성수지선 클릭됨!');
          switchLine('2성수', line2SeongsuStationData, 'line2-seongsu-stations');
        });
      }

      // 2호선 성수지선 개별 역 클릭 이벤트
      document.querySelectorAll('.line2-seongsu-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = line2SeongsuStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 2호선 신정지선 클릭 이벤트
      const line2SinjeongButton = document.querySelector('.line-2-sinjeong');
      if (line2SinjeongButton) {
        line2SinjeongButton.addEventListener('click', function() {
          console.log('2호선 신정지선 클릭됨!');
          switchLine('2신정', line2SinjeongStationData, 'line2-sinjeong-stations');
        });
      }

      // 2호선 신정지선 개별 역 클릭 이벤트
      document.querySelectorAll('.line2-sinjeong-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = line2SinjeongStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 3호선 클릭 이벤트
      const line3Button = document.querySelector('.line-3');
      if (line3Button) {
        line3Button.addEventListener('click', function() {
          console.log('3호선 클릭됨!');
          switchLine(3, line3StationData, 'line3-stations');
        });
      }

      // 4호선 클릭 이벤트
      const line4Button = document.querySelector('.line-4');
      if (line4Button) {
        line4Button.addEventListener('click', function() {
          console.log('4호선 클릭됨!');
          switchLine(4, line4StationData, 'line4-stations');
        });
      }

      // 5호선 클릭 이벤트
      const line5Button = document.querySelector('.line-5');
      if (line5Button) {
        line5Button.addEventListener('click', function() {
          console.log('5호선 클릭됨!');
          switchLine(5, line5StationData, 'line5-stations');
          // 5호선의 첫 번째 역(방화역)으로 설정
          document.getElementById('current-station').textContent = '방화';
          arrivalTimes = line5StationData['방화'].arrivals;
          updateArrivalTimes();
        });
      }

      // 6호선 클릭 이벤트
      const line6Button = document.querySelector('.line-6');
      if (line6Button) {
        line6Button.addEventListener('click', function() {
          console.log('6호선 클릭됨!');
          switchLine(6, line6StationData, 'line6-stations');
        });
      }

      // 7호선 클릭 이벤트
      const line7Button = document.querySelector('.line-7');
      if (line7Button) {
        line7Button.addEventListener('click', function() {
          console.log('7호선 클릭됨!');
          switchLine(7, line7StationData, 'line7-stations');
        });
      }

      // 8호선 클릭 이벤트
      const line8Button = document.querySelector('.line-8');
      if (line8Button) {
        line8Button.addEventListener('click', function() {
          console.log('8호선 클릭됨!');
          switchLine(8, line8StationData, 'line8-stations');
        });
      }

      // 9호선 클릭 이벤트
      const line9Button = document.querySelector('.line-9');
      if (line9Button) {
        line9Button.addEventListener('click', function() {
          console.log('9호선 클릭됨!');
          switchLine(9, line9StationData, 'line9-stations');
        });
      }

      // 신분당선 클릭 이벤트
      const shinbundangButton = document.querySelector('.line-sinbundang');
      if (shinbundangButton) {
        shinbundangButton.addEventListener('click', function() {
          switchLine('신분당', shinbundangStationData, 'shinbundang-stations');
          // 신분당선의 첫 번째 역(신사역)으로 설정
          document.getElementById('current-station').textContent = '신사';
          arrivalTimes = shinbundangStationData['신사'].arrivals;
          updateArrivalTimes();
        });
      }

      // 신분당선 개별 역 클릭 이벤트
      document.querySelectorAll('.shinbundang-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = shinbundangStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 경의중앙선 클릭 이벤트 (통합)
      const gyeonguiJungangButton = document.querySelector('.line-gyeongui-jungang');
      if (gyeonguiJungangButton) {
        gyeonguiJungangButton.addEventListener('click', function() {
          switchLine('경의중앙', gyeonguiJungangStationData, 'gyeongui-jungang-stations');
          document.getElementById('current-station').textContent = '문산';
          arrivalTimes = gyeonguiJungangStationData['문산'].arrivals;
          updateArrivalTimes();
        });
      }

      // 경의중앙선 개별 역 클릭 이벤트
      document.querySelectorAll('.gyeongui-jungang-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = gyeonguiJungangStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 우이신설선 클릭 이벤트
      const uiSinseolButton = document.querySelector('.line-ui-sinseol');
      if (uiSinseolButton) {
        uiSinseolButton.addEventListener('click', function() {
          switchLine('우이신설', uiSinseolStationData, 'ui-sinseol-stations');
          document.getElementById('current-station').textContent = '신설동';
          arrivalTimes = uiSinseolStationData['신설동'].arrivals;
          updateArrivalTimes();
        });
      } else {
        console.error('우이신설선 버튼을 찾을 수 없습니다!');
      }

      // 우이신설선 개별 역 클릭 이벤트
      document.querySelectorAll('.ui-sinseol-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = uiSinseolStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 신림선 클릭 이벤트
      const sillimButton = document.querySelector('.line-sillim');
      if (sillimButton) {
        sillimButton.addEventListener('click', function() {
          console.log('신림선 클릭됨!');
          switchLine('신림', sillimStationData, 'sillim-stations');
          document.getElementById('current-station').textContent = '신림';
          arrivalTimes = sillimStationData['신림'].arrivals;
          updateArrivalTimes();
        });
      }

      // 신림선 개별 역 클릭 이벤트
      document.querySelectorAll('.sillim-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = sillimStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 의정부경전철 클릭 이벤트
      const uijeongbuButton = document.querySelector('.line-uijeongbu');
      if (uijeongbuButton) {
        uijeongbuButton.addEventListener('click', function() {
          console.log('의정부경전철 클릭됨!');
          switchLine('의정부', uijeongbuStationData, 'uijeongbu-stations');
          document.getElementById('current-station').textContent = '발곡';
          arrivalTimes = uijeongbuStationData['발곡'].arrivals;
          updateArrivalTimes();
        });
      }

      // 의정부경전철 개별 역 클릭 이벤트
      document.querySelectorAll('.uijeongbu-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = uijeongbuStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 용인에버라인 클릭 이벤트
      const yonginEverlineButton = document.querySelector('.line-yongin-everline');
      if (yonginEverlineButton) {
        yonginEverlineButton.addEventListener('click', function() {
          console.log('용인에버라인 클릭됨!');
          switchLine('용인에버', yonginEverlineStationData, 'yongin-everline-stations');
          document.getElementById('current-station').textContent = '용인';
          arrivalTimes = yonginEverlineStationData['용인'].arrivals;
          updateArrivalTimes();
        });
      }

      // 용인에버라인 개별 역 클릭 이벤트
      document.querySelectorAll('.yongin-everline-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = yonginEverlineStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 분당선 클릭 이벤트
      const bundangButton = document.querySelector('.line-bundang');
      if (bundangButton) {
        bundangButton.addEventListener('click', function() {
          switchLine('분당', bundangStationData, 'bundang-stations');
          document.getElementById('current-station').textContent = '청량리';
          arrivalTimes = bundangStationData['청량리'].arrivals;
          updateArrivalTimes();
        });
      }

      // 분당선 개별 역 클릭 이벤트
      document.querySelectorAll('.bundang-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = bundangStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 경춘선 클릭 이벤트
      const gyeongchunButton = document.querySelector('.line-gyeongchun');
      if (gyeongchunButton) {
        gyeongchunButton.addEventListener('click', function() {
          switchLine('경춘', gyeongchunStationData, 'gyeongchun-stations');
          document.getElementById('current-station').textContent = '청량리';
          arrivalTimes = gyeongchunStationData['청량리'].arrivals;
          updateArrivalTimes();
        });
      }

      // 경춘선 개별 역 클릭 이벤트
      document.querySelectorAll('.gyeongchun-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = gyeongchunStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 경강선 클릭 이벤트
      const gyeonggangButton = document.querySelector('.line-gyeonggang');
      if (gyeonggangButton) {
        gyeonggangButton.addEventListener('click', function() {
          switchLine('경강', gyeonggangStationData, 'gyeonggang-stations');
          document.getElementById('current-station').textContent = '판교';
          arrivalTimes = gyeonggangStationData['판교'].arrivals;
          updateArrivalTimes();
        });
      }

      // 경강선 개별 역 클릭 이벤트
      document.querySelectorAll('.gyeonggang-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = gyeonggangStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 인천1호선 클릭 이벤트
      const incheon1Button = document.querySelector('.line-incheon1');
      if (incheon1Button) {
        incheon1Button.addEventListener('click', function() {
          console.log('인천1호선 클릭됨!');
          switchLine('인천1', incheon1StationData, 'incheon1-stations');
          document.getElementById('current-station').textContent = '검단';
          arrivalTimes = incheon1StationData['검단'].arrivals;
          updateArrivalTimes();
        });
      }

      // 인천1호선 개별 역 클릭 이벤트
      document.querySelectorAll('.incheon1-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = incheon1StationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 인천2호선 클릭 이벤트
      const incheon2Button = document.querySelector('.line-incheon2');
      if (incheon2Button) {
        incheon2Button.addEventListener('click', function() {
          console.log('인천2호선 클릭됨!');
          switchLine('인천2', incheon2StationData, 'incheon2-stations');
          document.getElementById('current-station').textContent = '검단오류';
          arrivalTimes = incheon2StationData['검단오류'].arrivals;
          updateArrivalTimes();
        });
      }

      // 인천2호선 개별 역 클릭 이벤트
      document.querySelectorAll('.incheon2-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = incheon2StationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 서해선 클릭 이벤트
      const seohaeButton = document.querySelector('.line-seohae');
      if (seohaeButton) {
        seohaeButton.addEventListener('click', function() {
          console.log('서해선 클릭됨!');
          switchLine('서해', seohaeStationData, 'seohae-stations');
          document.getElementById('current-station').textContent = '일산';
          arrivalTimes = seohaeStationData['일산'].arrivals;
          updateArrivalTimes();
        });
      }

      // 서해선 개별 역 클릭 이벤트
      document.querySelectorAll('.seohae-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = seohaeStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 김포골드라인 클릭 이벤트
      const gimpoButton = document.querySelector('.line-gimpo');
      if (gimpoButton) {
        gimpoButton.addEventListener('click', function() {
          switchLine('김포골드', gimpoStationData, 'gimpo-stations');
          document.getElementById('current-station').textContent = '김포공항';
          arrivalTimes = gimpoStationData['김포공항'].arrivals;
          updateArrivalTimes();
        });
      }

      // 김포골드라인 개별 역 클릭 이벤트
      document.querySelectorAll('.gimpo-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = gimpoStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // 공항철도 클릭 이벤트
      const airportButton = document.querySelector('.line-airport');
      if (airportButton) {
        airportButton.addEventListener('click', function() {
          switchLine('공항철도', airportStationData, 'airport-stations');
          document.getElementById('current-station').textContent = '서울역';
          arrivalTimes = airportStationData['서울역'].arrivals;
          updateArrivalTimes();
        });
      }

      // 공항철도 개별 역 클릭 이벤트
      document.querySelectorAll('.airport-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = airportStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });

      // GTX-A 클릭 이벤트
      const gtxAButton = document.querySelector('.line-gtx-a');
      if (gtxAButton) {
        gtxAButton.addEventListener('click', function() {
          switchLine('GTX-A', gtxAStationData, 'gtx-a-stations');
          document.getElementById('current-station').textContent = '운정';
          arrivalTimes = gtxAStationData['운정'].arrivals;
          updateArrivalTimes();
        });
      }

      // GTX-A 개별 역 클릭 이벤트
      document.querySelectorAll('.gtx-a-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.getAttribute('data-station');
          document.getElementById('current-station').textContent = stationName;
          arrivalTimes = gtxAStationData[stationName].arrivals;
          updateArrivalTimes();
        });
      });
      
      // 페이지 로드 시 1호선 색상으로 초기화
      updateLineColors(1);
      
      // 초기 로드 시 1호선 역들에만 클릭 이벤트 추가
      document.querySelectorAll('.line1-stations .station').forEach(station => {
        station.addEventListener('click', function() {
          const stationName = this.dataset.station;
          console.log(`${stationName}역 클릭됨 (초기 로드)`);
          document.getElementById('current-station').textContent = stationName;
          
          if (line1StationData[stationName]) {
            const arrivals = line1StationData[stationName].arrivals;
            arrivals.sort((a, b) => a - b);
            document.getElementById('next-train-1').textContent = `${arrivals[0]}분 후 도착`;
            document.getElementById('next-train-2').textContent = `${arrivals[1]}분 후 도착`;
          }
          
          // 클릭된 역 하이라이트
          document.querySelectorAll('.line1-stations .station').forEach(s => s.classList.remove('clicked'));
          this.classList.add('clicked');
        });
      });
      
      // 간단한 전역 클릭 이벤트 (디버깅용)
      document.addEventListener('click', function(event) {
        console.log('🖱️ 전체 클릭 이벤트 감지:', event.target);
        
        // 역 요소인지 확인
        if (event.target.closest('.station')) {
          const station = event.target.closest('.station');
          const stationName = station.dataset.station;
          console.log(`✅ 역 클릭됨: ${stationName}`);
          
          // 기본적인 역 이름 업데이트
          document.getElementById('current-station').textContent = stationName;
          
          // 하이라이트
          document.querySelectorAll('.station').forEach(s => s.classList.remove('clicked'));
          station.classList.add('clicked');
          
          // 간단한 도착 시간 설정 (테스트용)
          document.getElementById('next-train-1').textContent = '2분 후 도착';
          document.getElementById('next-train-2').textContent = '7분 후 도착';
        }
      });
      
      console.log('모든 이벤트 리스너 설정 완료!');
      
      // 강제 클릭 이벤트 추가 (모든 역에)
      setTimeout(() => {
        console.log('🔧 강제 클릭 이벤트 추가 중...');
        const allStations = document.querySelectorAll('.station');
        console.log(`총 ${allStations.length}개의 역 요소 발견`);
        
        allStations.forEach((station, index) => {
          // 기존 이벤트 리스너 제거
          station.onclick = null;
          
          // 새로운 클릭 이벤트 추가
          station.onclick = function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const stationName = this.dataset.station;
            console.log(`🎯 강제 클릭: ${stationName} 클릭됨 (${index + 1}번째)`);
            
            // 현재 역 업데이트
            document.getElementById('current-station').textContent = stationName;
            
            // 하이라이트
            document.querySelectorAll('.station').forEach(s => s.classList.remove('clicked'));
            this.classList.add('clicked');
            
            // 도착 시간 (테스트용)
            document.getElementById('next-train-1').textContent = '2분 후 도착';
            document.getElementById('next-train-2').textContent = '7분 후 도착';
            
            return false;
          };
        });
        
        console.log('✅ 모든 역에 강제 클릭 이벤트 추가 완료');
      }, 2000);
      
      // 클릭 이벤트 테스트 함수
      window.testClickEvents = function() {
        console.log('🧪 클릭 이벤트 테스트 시작...');
        const stations = document.querySelectorAll('.station');
        console.log(`총 ${stations.length}개의 역 요소 발견`);
        
        // 첫 번째 역 클릭 시뮬레이션
        if (stations.length > 0) {
          const firstStation = stations[0];
          const stationName = firstStation.dataset.station;
          console.log(`첫 번째 역 클릭 시뮬레이션: ${stationName}`);
          firstStation.click();
        }
      };
      
      // 페이지 상태 확인 함수
      window.checkPageStatus = function() {
        console.log('🔍 페이지 상태 확인 중...');
        
        // 역 요소 확인
        const stations = document.querySelectorAll('.station');
        console.log(`📊 총 역 개수: ${stations.length}`);
        
        // 현재 활성 노선 확인
        const activeLine = document.querySelector('.stations[style*="display: flex"]');
        console.log('📍 활성 노선:', activeLine ? activeLine.className : '없음');
        
        // 현재 역 확인
        const currentStation = document.getElementById('current-station');
        console.log('🚉 현재 역:', currentStation ? currentStation.textContent : '없음');
        
        // 도착 시간 확인
        const train1 = document.getElementById('next-train-1');
        const train2 = document.getElementById('next-train-2');
        console.log('🚂 도착 시간:', train1 ? train1.textContent : '없음', train2 ? train2.textContent : '없음');
        
        // API 키 확인
        console.log('🔑 API 키:', API_CONFIG.API_KEY ? '설정됨' : '없음');
        console.log('🔑 API 키 길이:', API_CONFIG.API_KEY ? API_CONFIG.API_KEY.length : 0);
        
        // 첫 번째 역 클릭 테스트
        if (stations.length > 0) {
          console.log('🧪 첫 번째 역 클릭 테스트...');
          stations[0].click();
        }
      };
      
      // API 테스트 함수
      window.testAPI = async function(stationName = '응암') {
        console.log('🧪 API 테스트 시작:', stationName);
        console.log('🔑 API 키:', API_CONFIG.API_KEY ? '설정됨' : '없음');
        console.log('🔑 API 키 길이:', API_CONFIG.API_KEY ? API_CONFIG.API_KEY.length : 0);
        
        try {
          const result = await getRealtimeArrival(stationName);
          console.log('📊 API 테스트 결과:', result);
          
          if (result && result.error) {
            console.error('❌ API 테스트 실패:', result.error, result.message);
          } else if (result && result.length > 0) {
            console.log('✅ API 테스트 성공:', result.length, '개 열차 정보');
            // 실제 도착시간 표시
            result.forEach((train, index) => {
              const minutes = train.barvlDt ? Math.round(train.barvlDt / 60) : 'N/A';
              console.log(`🚂 열차 ${index + 1}: ${minutes}분 후 도착 (${train.bstatnNm}행)`);
            });
          } else {
            console.warn('⚠️ API 테스트 결과: 데이터 없음');
          }
          
          return result;
        } catch (error) {
          console.error('❌ API 테스트 실패:', error);
          return { error: 'test_failed', message: error.message };
        }
      };
      
      // 여러 역으로 API 테스트
      window.testMultipleStations = async function() {
        const testStations = ['응암', '서울역', '강남', '종로3가', '신촌'];
        console.log('🧪 여러 역 API 테스트 시작...');
        
        for (const station of testStations) {
          console.log(`\n📍 ${station}역 테스트 중...`);
          const result = await testAPI(station);
          await new Promise(resolve => setTimeout(resolve, 1000)); // 1초 대기
        }
        
        console.log('\n✅ 모든 역 테스트 완료');
      };
      
      // 3호선 특정 역 테스트
      window.testLine3Stations = async function() {
        const line3Stations = ['대화', '주엽', '정발산', '마두', '백석', '대곡', '화정', '원당', '원흥', '삼송', '지축', '구파발', '연신내', '불광', '녹천', '월계', '광운대', '석계', '신이문', '외대앞', '회기', '청량리', '동대문', '동대문역사문화공원', '충무로', '을지로3가', '종로3가', '안국', '경복궁', '독립문', '무악재', '홍제', '녹번'];
        
        console.log('🚇 3호선 역들 API 테스트 시작...');
        
        for (const station of line3Stations.slice(0, 10)) { // 처음 10개만 테스트
          console.log(`\n📍 ${station}역 테스트 중...`);
          const result = await testAPI(station);
          
          if (result && !result.error && result.length > 0) {
            console.log(`✅ ${station}역: 실시간 데이터 있음`);
            // 행선지 정보 상세 출력
            result.forEach((train, index) => {
              console.log(`  🚂 열차 ${index + 1}: ${train.bstatnNm}행 (${train.updnLine})`);
            });
          }
          
          await new Promise(resolve => setTimeout(resolve, 1000)); // 1초 대기
        }
      };
      
      // 실시간 섹션 기능 초기화 (개선된 버전)
      function initializeRealtimeSection() {
        // ★ 본인 키로 교체
        const API_KEY = "4974716f4269746f3738566c474c46";

        const $input = document.getElementById("stationInput");
        const $apply = document.getElementById("stationApply");
        const $list  = document.getElementById("arrivalList");
        const $stamp = document.getElementById("lastUpdated");

        let timer = null;
        let inFlight = null; // AbortController

        // 자연어 검색 함수
        async function smartSearch(naturalKorean) {
          try {
            console.log(`🔍 자연어 검색: "${naturalKorean}"`);
            
            const r = await fetch("/api/nl-search", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ query: naturalKorean })
            });
            
            if (!r.ok) {
              throw new Error(`서버 오류: ${r.status}`);
            }
            
            const parsed = await r.json();
            console.log(`✅ 파싱 결과:`, parsed);
            
            if (!parsed.data || !parsed.data.station) {
              throw new Error("역을 인식하지 못했습니다.");
            }
            
            // 파싱된 역명으로 검색 실행
            await fetchArrivals(parsed.data.station);
            
            // 입력창에 파싱된 역명 표시
            $input.value = parsed.data.station;
            
            // 파싱 정보 표시 (선택사항)
            if (parsed.data.line || parsed.data.direction) {
              const info = [];
              if (parsed.data.line) info.push(`노선: ${parsed.data.line}`);
              if (parsed.data.direction && parsed.data.direction !== '미상') {
                info.push(`방향: ${parsed.data.direction}`);
              }
              if (info.length > 0) {
                console.log(`📋 추가 정보: ${info.join(', ')}`);
              }
            }
            
          } catch (error) {
            console.error('❌ 자연어 검색 실패:', error);
            
            // 자연어 검색 실패 시 일반 검색으로 폴백
            console.log('🔄 일반 검색으로 폴백...');
            await fetchArrivals(naturalKorean);
          }
        }

        // 한글 역명 안전처리 & "역" 제거
        function normalizeStation(raw) {
          if (!raw) return "";
          return raw.trim().replace(/역$/, ""); // 뒤의 '역' 한 글자 제거
        }

        // 분 텍스트 → 정렬용 숫자(곧 도착=0, "전역 출발"은 0.5 같은 식) 
        function parseEta(s) {
          if (!s) return 999;
          if (/곧\s*도착/.test(s)) return 0;
          const m = s.match(/(\d+)\s*분/);
          if (m) return parseInt(m[1], 10);
          // "전역 출발", "진입" 등은 0~1분 사이로 대충 정렬
          if (/전역|진입|출발/.test(s)) return 0.5;
          return 999;
        }

        // 도착 정보 렌더링
        function render(list) {
          if (!Array.isArray(list) || list.length === 0) {
            $list.innerHTML = `<li class="empty">표시할 열차가 없어요.</li>`;
            return;
          }
          // 최신/가까운 순으로 정렬
          list.sort((a, b) => parseEta(a.arvlMsg2) - parseEta(b.arvlMsg2));
          const html = list.slice(0, 12).map(row => {
            const dir = (row.updnLine || "").replace(/\s/g,""); // 상행/하행
            const msg2 = row.arvlMsg2 || "";  // "3분 후", "곧 도착" 등
            const where = row.trainLineNm || ""; // "OO행 (OO방면)"
            const track = row.btrainNo ? `#${row.btrainNo}` : "";
            return `
              <li>
                <div class="arrival-info">
                  <div class="arrival-destination">${where || row.bstatnNm || '정보없음'}행</div>
                  <div class="arrival-direction">${dir} 방향</div>
                </div>
                <div>
                  <div class="arrival-time">${msg2}</div>
                  <div class="arrival-status">${track}</div>
                </div>
              </li>`;
          }).join("");
          $list.innerHTML = html;
        }

        // API 호출 (HTTPS, CORS OK)
        async function fetchArrivals(station) {
          const clean = normalizeStation(station);
          if (!clean) {
            render([]);
            $stamp.textContent = "역 이름을 입력하세요.";
            return;
          }

          // 진행 중 요청 취소
          if (inFlight) inFlight.abort();
          inFlight = new AbortController();

          const url = `https://swopenapi.seoul.go.kr/api/subway/${API_KEY}/json/realtimeStationArrival/0/40/${encodeURIComponent(clean)}`;

          try {
            const res = await fetch(url, { signal: inFlight.signal, cache: "no-store" });
            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            const data = await res.json();

            // 응답 형식 체크
            const ok = data?.errorMessage?.status === 200 || Array.isArray(data?.realtimeArrivalList);
            if (!ok) {
              render([]);
              $stamp.textContent = "API 응답 형식이 예상과 달라요.";
              return;
            }
            render(data.realtimeArrivalList || []);
            const t = new Date();
            $stamp.textContent = `업데이트: ${t.toLocaleTimeString()}`;
          } catch (err) {
            if (err.name === "AbortError") return; // 새 요청으로 교체됨
            render([]);
            $stamp.textContent = "네트워크 오류 또는 호출 차단(CORS) 문제";
            console.error(err);
          }
        }

        // 15초마다 자동 새로고침 + 즉시 1회 (자연어 검색 사용)
        function startAuto(station) {
          clearInterval(timer);
          smartSearch(station); // 자연어 검색으로 즉시 1회
          timer = setInterval(() => smartSearch(station), 15000);
        }

        // 버튼/엔터로 적용
        $apply.addEventListener("click", () => startAuto($input.value));
        $input.addEventListener("keydown", (e) => {
          if (e.key === "Enter") startAuto($input.value);
        });

        // 페이지 첫 진입 시 기본값 없음 (사용자가 직접 입력)
      }
      
      // 실시간 섹션 기능 초기화
      initializeRealtimeSection();
      
      // DOM이 완전히 로드된 후 1호선으로 초기화
      console.log('1호선으로 초기화');
      
      // 시계 밑 호선 정보 초기화
      document.querySelector('.line-number').textContent = '1';
      document.querySelector('.line-name').textContent = '1호선';
      
      switchLine(1, line1StationData, 'line1-stations');
      
      // API 호출 시작
      console.log('API 호출 시작');
      updateDisplay();
      
      // 30초마다 도착시간 업데이트 (실제 API 사용시 더 자주 업데이트)
      setInterval(updateDisplay, 30000);

      // 검색 기능 초기화
      initializeSearch();
    });

    // 검색 기능 초기화
    function initializeSearch() {
      const searchInput = document.getElementById('station-search');
      const searchBtn = document.getElementById('search-btn');
      const searchResults = document.getElementById('search-results');

      // 모든 역 데이터 수집
      const allStations = {
        '1호선': line1StationData,
        '2호선 본선': line2MainStationData,
        '2호선 성수지선': line2SeongsuStationData,
        '2호선 신정지선': line2SinjeongStationData,
        '3호선': line3StationData,
        '4호선': line4StationData,
        '5호선': line5StationData,
        '6호선': line6StationData,
        '7호선': line7StationData,
        '8호선': line8StationData,
        '9호선': line9StationData,
        '신분당선': shinbundangStationData,
        '경의중앙선': gyeonguiJungangStationData,
        'GTX-A': gtxAStationData,
        '우이신설선': uiSinseolStationData,
        '신림선': sillimStationData,
        '의정부경전철': uijeongbuStationData,
        '용인에버라인': yonginEverlineStationData,
        '분당선': bundangStationData,
        '경춘선': gyeongchunStationData,
        '경강선': gyeonggangStationData,
        '인천1호선': incheon1StationData,
        '인천2호선': incheon2StationData,
        '서해선': seohaeStationData,
        '공항철도': airportStationData,
        '김포골드라인': gimpoStationData
      };

      // 검색 함수
      function searchStations(query) {
        if (!query.trim()) {
          searchResults.innerHTML = '';
          return;
        }

        const results = [];
        const searchTerm = query.toLowerCase().trim();

        // 각 노선에서 역 검색
        Object.keys(allStations).forEach(lineName => {
          const stationData = allStations[lineName];
          Object.keys(stationData).forEach(stationName => {
            if (stationName.toLowerCase().includes(searchTerm)) {
              results.push({
                name: stationName,
                line: lineName,
                data: stationData[stationName]
              });
            }
          });
        });

        displaySearchResults(results);
      }

      // 검색 결과 표시
      function displaySearchResults(results) {
        if (results.length === 0) {
          searchResults.innerHTML = '<div class="no-results">검색 결과가 없습니다.</div>';
          return;
        }

        const resultsHTML = results.map(result => `
          <div class="search-result-item" data-station="${result.name}" data-line="${result.line}">
            <div class="station-name">${result.name}</div>
            <div class="line-info">${result.line}</div>
          </div>
        `).join('');

        searchResults.innerHTML = resultsHTML;

        // 검색 결과 클릭 이벤트
        document.querySelectorAll('.search-result-item').forEach(item => {
          item.addEventListener('click', function() {
            const stationName = this.dataset.station;
            const lineName = this.dataset.line;
            
            // 도라산역 특별 처리: 노선도에서 표시
            if (stationName === '도라산') {
              const dorasanStation = document.querySelector('[data-station="도라산"]');
              if (dorasanStation) {
                dorasanStation.style.display = 'block';
              }
            }
            
            // 해당 노선으로 전환
            switchToLineByStation(stationName, lineName);
            
            // 검색 결과 숨기기
            searchResults.innerHTML = '';
            searchInput.value = '';
          });
        });
      }

      // 역 이름으로 노선 전환
      function switchToLineByStation(stationName, lineName) {
        let lineNumber, stationData, stationClass;

        switch(lineName) {
          case '1호선':
            lineNumber = 1;
            stationData = line1StationData;
            stationClass = 'line1-stations';
            break;
          case '2호선 본선':
            lineNumber = 2;
            stationData = line2MainStationData;
            stationClass = 'line2-main-stations';
            break;
          case '2호선 성수지선':
            lineNumber = '2성수';
            stationData = line2SeongsuStationData;
            stationClass = 'line2-seongsu-stations';
            break;
          case '2호선 신정지선':
            lineNumber = '2신정';
            stationData = line2SinjeongStationData;
            stationClass = 'line2-sinjeong-stations';
            break;
          case '3호선':
            lineNumber = 3;
            stationData = line3StationData;
            stationClass = 'line3-stations';
            break;
          case '4호선':
            lineNumber = 4;
            stationData = line4StationData;
            stationClass = 'line4-stations';
            break;
          case '5호선':
            lineNumber = 5;
            stationData = line5StationData;
            stationClass = 'line5-stations';
            break;
          case '6호선':
            lineNumber = 6;
            stationData = line6StationData;
            stationClass = 'line6-stations';
            break;
          case '7호선':
            lineNumber = 7;
            stationData = line7StationData;
            stationClass = 'line7-stations';
            break;
          case '8호선':
            lineNumber = 8;
            stationData = line8StationData;
            stationClass = 'line8-stations';
            break;
          case '9호선':
            lineNumber = 9;
            stationData = line9StationData;
            stationClass = 'line9-stations';
            break;
          case '신분당선':
            lineNumber = '신분당';
            stationData = shinbundangStationData;
            stationClass = 'shinbundang-stations';
            break;
          // ✅ 경의·중앙선으로 통합 매핑
          case '경의선':
            lineNumber = '경의중앙';
            stationData = gyeonguiJungangStationData;
            stationClass = 'gyeongui-jungang-stations';
            break;

          case '용산선':
            lineNumber = '경의중앙';
            stationData = gyeonguiJungangStationData;
            stationClass = 'gyeongui-jungang-stations';
            break;

          case '경원선':
            lineNumber = '경의중앙';
            stationData = gyeonguiJungangStationData;
            stationClass = 'gyeongui-jungang-stations';
            break;

          case '중앙선':
            lineNumber = '경의중앙';
            stationData = gyeonguiJungangStationData;
            stationClass = 'gyeongui-jungang-stations';
            break;

          // (선택) '경의중앙선' 라벨도 직접 받을 수 있게
          case '경의중앙선':
            lineNumber = '경의중앙';
            stationData = gyeonguiJungangStationData;
            stationClass = 'gyeongui-jungang-stations';
            break;
          case '우이신설선':
            lineNumber = '우이신설';
            stationData = uiSinseolStationData;
            stationClass = 'ui-sinseol-stations';
            break;
          case '신림선':
            lineNumber = '신림';
            stationData = sillimStationData;
            stationClass = 'sillim-stations';
            break;
          case '의정부경전철':
            lineNumber = '의정부';
            stationData = uijeongbuStationData;
            stationClass = 'uijeongbu-stations';
            break;
          case '용인에버라인':
            lineNumber = '용인에버';
            stationData = yonginEverlineStationData;
            stationClass = 'yongin-everline-stations';
            break;
          case '분당선':
            lineNumber = '분당';
            stationData = bundangStationData;
            stationClass = 'bundang-stations';
            break;
          case '경춘선':
            lineNumber = '경춘';
            stationData = gyeongchunStationData;
            stationClass = 'gyeongchun-stations';
            break;
          case '경강선':
            lineNumber = '경강';
            stationData = gyeonggangStationData;
            stationClass = 'gyeonggang-stations';
            break;
          case '인천1호선':
            lineNumber = '인천1';
            stationData = incheon1StationData;
            stationClass = 'incheon1-stations';
            break;
          case '인천2호선':
            lineNumber = '인천2';
            stationData = incheon2StationData;
            stationClass = 'incheon2-stations';
            break;
          case '서해선':
            lineNumber = '서해';
            stationData = seohaeStationData;
            stationClass = 'seohae-stations';
            break;
          case '공항철도':
            lineNumber = '공항철도';
            stationData = airportStationData;
            stationClass = 'airport-stations';
            break;
          case '김포골드라인':
            lineNumber = '김포골드';
            stationData = gimpoStationData;
            stationClass = 'gimpo-stations';
            break;
        }

        if (lineNumber && stationData && stationClass) {
          // 노선 전환
          switchLine(lineNumber, stationData, stationClass);
          
          // 해당 역으로 설정
          document.getElementById('current-station').textContent = stationName;
          if (stationData[stationName]) {
            arrivalTimes = stationData[stationName].arrivals;
            updateArrivalTimes();
          }
          
          // 해당 역 하이라이트
          setTimeout(() => {
            const targetStation = document.querySelector(`.${stationClass} .station[data-station="${stationName}"]`);
            if (targetStation) {
              targetStation.scrollIntoView({ behavior: 'smooth', block: 'center' });
              targetStation.classList.add('clicked');
            }
          }, 100);
        }
      }

      // 검색 버튼 클릭 이벤트
      searchBtn.addEventListener('click', function() {
        const query = searchInput.value.trim();
        if (query) {
          // 새로운 API 함수로 실시간 데이터 가져오기
          getRealtimeArrival(query).then(result => {
            // 오류 상태 확인
            if (result && result.error) {
              console.log(`${query}역 API 오류:`, result.error, result.message);
              updateAPIStatus(result.error, result.message);
              alert(`${query}역 API 오류: ${result.message}`);
              return;
            }
            
            if (result && result.length > 0) {
              // 현재 역 업데이트
              document.getElementById('current-station').textContent = query;
              
              // displayRealTimeData 함수를 사용하여 방향별로 표시
              displayRealTimeData(result);
              
              updateAPIStatus('connected', '실시간 데이터 연결됨');
              console.log(`${query}역 실시간 데이터 로드 완료`);
            } else {
              console.log(`${query}역 도착 정보 없음`);
              updateAPIStatus('failed', '도착 정보 없음');
              alert(`${query}역의 도착 정보를 찾을 수 없습니다.`);
            }
          });
          
          // 기존 검색 기능도 실행
          searchStations(query);
        }
      });

      // 엔터키 검색
      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          const query = searchInput.value.trim();
          if (query) {
            // 새로운 API 함수로 실시간 데이터 가져오기
            getRealtimeArrival(query).then(result => {
              // 오류 상태 확인
              if (result && result.error) {
                console.log(`${query}역 API 오류:`, result.error, result.message);
                updateAPIStatus(result.error, result.message);
                alert(`${query}역 API 오류: ${result.message}`);
                return;
              }
              
              if (result && result.length > 0) {
                // 현재 역 업데이트
                document.getElementById('current-station').textContent = query;
                
                // displayRealTimeData 함수를 사용하여 방향별로 표시
                displayRealTimeData(result);
                
                updateAPIStatus('connected', '실시간 데이터 연결됨');
                console.log(`${query}역 실시간 데이터 로드 완료`);
              } else {
                console.log(`${query}역 도착 정보 없음`);
                updateAPIStatus('failed', '도착 정보 없음');
                alert(`${query}역의 도착 정보를 찾을 수 없습니다.`);
              }
            });
            
            // 기존 검색 기능도 실행
            searchStations(query);
          }
        }
      });

      // 실시간 검색 (입력할 때마다)
      searchInput.addEventListener('input', function() {
        const query = searchInput.value;
        if (query.length >= 2) {
          searchStations(query);
        } else {
          searchResults.innerHTML = '';
        }
      });
    }
  </script>
<script>
(function () {
  const lineBlocks = document.querySelectorAll('.stations');
  const globalMap = new Map();
  const issues = [];
  const transferStations = new Set(); // 환승역 추적용
  
  // 알려진 환승역 목록 (주요 환승역들)
  const knownTransferStations = [
    '시청', '신도림', '성수', '신설동', '종로3가', '을지로3가', '교대', '창동', 
    '동대문', '동대문역사문화공원', '충무로', '서울역', '사당', '금정', '까치산', 
    '영등포구청', '신길', '충정로', '을지로4가', '왕십리', '불광', '연신내', 
    '합정', '삼각지', '약수', '청구', '신당', '동묘앞', '석계', '도봉산', '노원', 
    '태릉입구', '군자', '건대입구', '고속터미널', '총신대입구', '대림', '가산디지털단지',
    '천호', '잠실', '가락시장', '김포공항', '당산', '여의도', '동작', '종합운동장', 
    '석촌', '신사', '논현', '신논현', '강남', '양재', '대곡', '디지털미디어시티', 
    '홍대입구', '신촌', '효창공원앞', '용산', '이촌', '옥수', '청량리', '회기', 
    '상봉', '양평', '삼성', '수서', '보문', '성신여대입구', '신림', '샛강', 
    '대방', '보라매', '회룡', '강남구청', '선정릉', '선릉', '도곡', '복정', 
    '모란', '수원', '신내', '석남', '부천종합운동장', '초지', '마곡나루'
  ];
  
  lineBlocks.forEach(block => {
    const classList = [...block.classList];
    const lineClass = classList.find(c => c.startsWith('line') && c.endsWith('-stations')) || 
                     classList.find(c => c.includes('-stations')) || 
                     classList[0] || 'unknown-line';
    const seen = new Set();
    block.querySelectorAll('.station').forEach(st => {
      const name = (st.getAttribute('data-station')||'').trim();
      if (!name) return;
      
      // 동일 노선 내 중복 체크
      if (seen.has(name)) {
        issues.push(`[${lineClass}] 동일 노선 내 역 중복: ${name}`);
      }
      seen.add(name);
      
      // 노선 간 중복 체크
      const existing = globalMap.get(name);
      if (existing && existing !== lineClass) {
        // 환승역인지 확인
        if (knownTransferStations.includes(name)) {
          transferStations.add(name);
          // 환승역은 정보만 출력 (경고가 아님)
          console.info(`🔄 환승역: ${name} (${existing} ↔ ${lineClass})`);
        } else {
          // 알려지지 않은 중복은 경고
          issues.push(`⚠️ 노선 간 중복: ${name} (이미 ${existing}에 있음, 현재 ${lineClass})`);
        }
      } else if (!existing) {
        globalMap.set(name, lineClass);
      }
    });
  });
  
  if (issues.length) {
    console.group('%c🚨 역 목록 점검 결과 - 문제 발견', 'color:#d33;font-weight:bold');
    for (const i of issues) console.warn(i);
    console.groupEnd();
  } else {
    console.group('%c✅ 역 목록 점검 결과', 'color:#28a745;font-weight:bold');
    console.info('동일 노선 내 중복: 없음');
    console.info(`환승역 개수: ${transferStations.size}개`);
    console.info('전체 점검: 이상 없음');
    console.groupEnd();
  }
})();
</script>

<script>
(function(){
  // Helper: reverse children of a node in-place
  function reverseChildren(node){
    const kids = Array.from(node.children);
    for(let i=kids.length-1;i>=0;i--){
      node.appendChild(kids[i]);
    }
  }

  // Current direction state (default 상행=up)
  let currentDir = 'up';

  function applyDirectionToVisible(){
    const visible = document.querySelectorAll('.stations');
    visible.forEach(wrap => {
      const isHidden = window.getComputedStyle(wrap).display === 'none';
      if (isHidden) return;
      const flag = wrap.getAttribute('data-reversed') === 'true';
      if (currentDir === 'up' && !flag){
        reverseChildren(wrap);
        wrap.setAttribute('data-reversed','true');
      } else if (currentDir === 'down' && flag){
        reverseChildren(wrap);
        wrap.setAttribute('data-reversed','false');
      }
    });
  }

  // Wire direction radios
  document.querySelectorAll('input[name="dir"]').forEach(r => {
    r.addEventListener('change', (e)=>{
      currentDir = e.target.value; // 'down' or 'up'
      applyDirectionToVisible();
      
      // 방향 변경 시 실시간 데이터 다시 표시
      console.log(`🔄 방향 변경: ${e.target.value === 'up' ? '상행' : '하행'}`);
      if (window.lastAPIData && window.lastAPIData.length > 0) {
        console.log('🔄 기존 API 데이터로 방향별 열차 정보 업데이트');
        displayRealTimeData(window.lastAPIData);
      }
    });
  });

  // Hook into existing line switching: observe when a .stations block becomes visible
  // If there are line buttons with data-target attributes, we also patch click handlers.
  // As a general fallback, we use a MutationObserver to detect display changes.
  const obs = new MutationObserver((mutations)=>{
    for(const m of mutations){
      if (m.type === 'attributes' && m.attributeName === 'style'){
        applyDirectionToVisible();
      }
    }
  });
  document.querySelectorAll('.stations').forEach(wrap => obs.observe(wrap, {attributes:true}));

  // Initial apply for default visible line(s)
  applyDirectionToVisible();

})();
</script>
</body>
<script>
  /* 현재 보이는 노선의 가장 바깥 종점(한쪽)만 숨기고, '○○행' 목적지 텍스트는 그대로 유지 */
  (function () {
    // 방향 라디오의 현재 값 읽기 (기본: 하행 down, 상행 up)
    function getCurrentDir() {
      const checked = document.querySelector('input[name="dir"]:checked');
      return checked ? checked.value : 'down'; // 'up' | 'down'
    }
  
    // 현재 화면에 보이는 .stations 한 개 찾기
    function getVisibleStationsWrap() {
      const wraps = Array.from(document.querySelectorAll('.stations'));
      return wraps.find(w => getComputedStyle(w).display !== 'none') || null;
    }
  
    // 종점 숨김 적용: 현재 방향 기준 바깥쪽 하나만 숨김
    function applyTerminalHiding() {
      const wrap = getVisibleStationsWrap();
      if (!wrap) return;
      const items = Array.from(wrap.querySelectorAll('.station'));
      // 초기화
      items.forEach(el => el.classList.remove('is-terminal'));
  
      if (items.length < 3) return; // 너무 짧으면 생략
  
      const dir = getCurrentDir();
      // 상행(up): 목록의 "앞쪽" 역(북단 등) 숨김
      // 하행(down): 목록의 "뒤쪽" 역(남단 등) 숨김
      if (dir === 'up') {
        items[0].classList.add('is-terminal');
      } else {
        items[items.length - 1].classList.add('is-terminal');
      }
    }
  
    // 방향 바뀔 때마다 적용
    document.querySelectorAll('input[name="dir"]').forEach(r => {
      r.addEventListener('change', applyTerminalHiding);
    });
  
    // 노선 전환 등으로 display가 바뀔 때도 적용
    const mo = new MutationObserver(muts => {
      for (const m of muts) {
        if (m.type === 'attributes' && m.attributeName === 'style') {
          applyTerminalHiding();
        }
      }
    });
    document.querySelectorAll('.stations').forEach(w => mo.observe(w, { attributes: true }));
  
    // 최초 1회
    window.addEventListener('load', applyTerminalHiding);
    // 혹시 초기 렌더 타이밍 이슈 대비
    setTimeout(applyTerminalHiding, 0);
  })();
  </script>

  <!-- 클라이언트 검색 스크립트 -->
  <script>
    const $input = document.getElementById('station-search');
    const $btn = document.getElementById('search-btn');
    const $eta1 = document.getElementById('next-train-1');
    const $eta2 = document.getElementById('next-train-2');
    const $dest1 = document.getElementById('current-train-dest');
    const $dest2 = document.getElementById('next-train-dest');
    const $stationTitle = document.getElementById('current-station');

    async function run(station) {
      if (!station) return;
      $stationTitle.textContent = station;
      $eta1.textContent = '불러오는 중…';
      $eta2.textContent = '';

      try {
        const r = await fetch(`/api/subway/${encodeURIComponent(station)}`);
        const json = await r.json();
        const list = json?.data?.realtimeArrivalList || [];

        if (!list.length) {
          $eta1.textContent = '도착 정보 없음';
          $dest1.textContent = '이번열차';
          $eta2.textContent = '';
          $dest2.textContent = '다음열차';
          return;
        }

        // 1번/2번만 간단 표시
        const [a, b] = [list[0], list[1]];
        if (a) {
          $dest1.textContent = `이번열차 ${a.bstatnNm}행`;
          $eta1.textContent = a.arvlMsg2 || a.arvlMsg3 || '정보없음';
        }
        if (b) {
          $dest2.textContent = `다음열차 ${b.bstatnNm}행`;
          $eta2.textContent = b.arvlMsg2 || b.arvlMsg3 || '정보없음';
        }
      } catch (error) {
        console.error('검색 오류:', error);
        $eta1.textContent = '오류 발생';
        $dest1.textContent = '이번열차';
        $eta2.textContent = '';
        $dest2.textContent = '다음열차';
      }
    }

    $btn.addEventListener('click', () => run($input.value.trim()));
    $input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') run($input.value.trim());
    });
  </script>
  
</html>